//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyZXF1ZXN0X2V4cG9ydHMiLCJfX2V4cG9ydCIsInJlcXVlc3QiLCJfX0VYUE9SVFNfXyIsImltcG9ydF92YWx5cmlhbiIsInJlcXVpcmUiLCJpbXBvcnRfdXRpbHMiLCJzZXJpYWxpemUiLCJvYmoiLCJwcmVmaXgiLCJwYXJhbXMiLCJVUkxTZWFyY2hQYXJhbXMiLCJPYmplY3QiLCJrZXlzIiwiZm9yRWFjaCIsInByb3AiLCJrZXkiLCJhcHBlbmQiLCJ0b1N0cmluZyIsImRlZmF1bHRPcHRpb25zIiwiYWxsb3dlZE1ldGhvZHMiLCJSZXF1ZXN0ZXIiLCJiYXNlVXJsIiwib3B0aW9ucyIsInVybCIsInJlcGxhY2UiLCJ0cmltIiwidXJscyIsImJhc2UiLCJub2RlIiwiYXBpIiwib3B0cyIsImFzeW5jIiwibWV0aG9kIiwiZGF0YSIsImlubmVyT3B0aW9ucyIsInRvVXBwZXJDYXNlIiwiaGVhZGVycyIsInJlc29sdmVXaXRoRnVsbFJlc3BvbnNlIiwiQWNjZXB0IiwiYWNjZXB0VHlwZSIsImNvbnRlbnRUeXBlIiwiaW5jbHVkZXMiLCJFcnJvciIsImpvaW4iLCJmaW5hbFVybCIsInVybFdpdGhvdXRTbGFzaCIsInUiLCJ0ZXN0IiwiaXNOb2RlSnMiLCJVUkwiLCJwYXJzZVVybCIsImVycm9yIiwiaXNKc29uIiwic2VhcmNoIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlbnRyaWVzIiwicmVkdWNlIiwiZmQiLCJ2YWx1ZSIsIkZvcm1EYXRhIiwic2VyaWFsaXplRm9ybURhdGEiLCJyZXNwb25zZSIsImZldGNoIiwib2siLCJlcnIiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwidGV4dCIsImpzb24iLCJjb25zb2xlIiwid2FybiIsImJsb2IiLCJhcnJheUJ1ZmZlciIsIm5ldyIsInNldE9wdGlvbiIsInNldCIsImdldE9wdGlvbnMiLCJnZXQiLCJhc3NpZ24iLCJhY2MiXSwic291cmNlcyI6WyIuLi8uLi9saWIvcmVxdWVzdC9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBpc05vZGVKcyB9IGZyb20gXCJ2YWx5cmlhbi5qc1wiO1xuaW1wb3J0IHsgZ2V0LCBzZXQgfSBmcm9tIFwidmFseXJpYW4uanMvdXRpbHNcIjtcblxuaW50ZXJmYWNlIFVybE9wdGlvbnMge1xuICBiYXNlPzogc3RyaW5nOyAvLyBVc2VkIHRvIHByZWZpeCB0aGUgdXJsIGZvciBzY29wZWQgcmVxdWVzdHMuXG4gIG5vZGU/OiBzdHJpbmcgfCBudWxsOyAvLyBVc2VkIHRvIHJlZGlyZWN0IGxvY2FsIHJlcXVlc3RzIHRvIG5vZGUgc2VydmVyIGZvciBzZXJ2ZXIgc2lkZSByZW5kZXJpbmcuXG4gIGFwaT86IHN0cmluZyB8IG51bGw7IC8vIFVzZWQgdG8gcmVkaXJlY3QgYXBpIHJlcXVlc3RzIHRvIG5vZGUgc2VydmVyIGZvciBzZXJ2ZXIgc2lkZSByZW5kZXJpbmcuXG59XG5cbmludGVyZmFjZSBSZXF1ZXN0T3B0aW9ucyB7XG4gIGFsbG93ZWRNZXRob2RzPzogc3RyaW5nW107XG4gIHVybHM/OiBVcmxPcHRpb25zO1xuICBba2V5OiBzdHJpbmcgfCBudW1iZXIgfCBzeW1ib2xdOiBhbnk7XG59XG5cbmludGVyZmFjZSBSZXF1ZXN0T3B0aW9uc1dpdGhVcmxzIGV4dGVuZHMgUmVxdWVzdE9wdGlvbnMge1xuICB1cmxzOiBVcmxPcHRpb25zO1xuICBhbGxvd2VkTWV0aG9kczogc3RyaW5nW107XG59XG5cbmludGVyZmFjZSBTZW5kT3B0aW9ucyBleHRlbmRzIFJlcXVlc3RPcHRpb25zV2l0aFVybHMsIFJlcXVlc3RJbml0IHtcbiAgYWxsb3dlZE1ldGhvZHM6IHN0cmluZ1tdO1xuICBtZXRob2Q6IHN0cmluZztcbiAgaGVhZGVyczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U/OiBib29sZWFuO1xufVxuXG5leHBvcnQgaW50ZXJmYWNlIFJlcXVlc3RJbnRlcmZhY2Uge1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgKG1ldGhvZDogc3RyaW5nLCB1cmw6IHN0cmluZywgZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsLCBvcHRpb25zPzogUGFydGlhbDxTZW5kT3B0aW9ucz4pOiBhbnkgfCBSZXNwb25zZTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIG5ldzogKGJhc2VVcmw6IHN0cmluZywgb3B0aW9ucz86IFJlcXVlc3RPcHRpb25zKSA9PiBSZXF1ZXN0SW50ZXJmYWNlO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgc2V0T3B0aW9uczogKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB2b2lkO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZ2V0T3B0aW9uczogKGtleT86IHN0cmluZykgPT4gUmVxdWVzdE9wdGlvbnMgfCB2b2lkO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZ2V0OiAodXJsOiBzdHJpbmcsIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgbnVsbCwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IGFueSB8IFJlc3BvbnNlO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgcG9zdDogKHVybDogc3RyaW5nLCBkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PiB8IG51bGwsIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBhbnkgfCBSZXNwb25zZTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIHB1dDogKHVybDogc3RyaW5nLCBkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PiB8IG51bGwsIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBhbnkgfCBSZXNwb25zZTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIHBhdGNoOiAodXJsOiBzdHJpbmcsIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgbnVsbCwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IGFueSB8IFJlc3BvbnNlO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZGVsZXRlOiAodXJsOiBzdHJpbmcsIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgbnVsbCwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+IGFueSB8IFJlc3BvbnNlO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgaGVhZDogKHVybDogc3RyaW5nLCBkYXRhPzogUmVjb3JkPHN0cmluZywgYW55PiB8IG51bGwsIG9wdGlvbnM/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+KSA9PiBhbnkgfCBSZXNwb25zZTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIG9wdGlvbnM6ICh1cmw6IHN0cmluZywgZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsLCBvcHRpb25zPzogUmVjb3JkPHN0cmluZywgYW55PikgPT4gYW55IHwgUmVzcG9uc2U7XG4gIFtrZXk6IHN0cmluZyB8IG51bWJlciB8IHN5bWJvbF06IGFueTtcbn1cblxuLy8gVGhpcyBtZXRob2QgaXMgdXNlZCB0byBzZXJpYWxpemUgYW4gb2JqZWN0IGludG8gYSBxdWVyeSBzdHJpbmcuXG5mdW5jdGlvbiBzZXJpYWxpemUob2JqOiBSZWNvcmQ8c3RyaW5nLCBhbnk+LCBwcmVmaXg6IHN0cmluZyA9IFwiXCIpOiBVUkxTZWFyY2hQYXJhbXMge1xuICBjb25zdCBwYXJhbXMgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKCk7XG5cbiAgT2JqZWN0LmtleXMob2JqKS5mb3JFYWNoKChwcm9wOiBzdHJpbmcpID0+IHtcbiAgICBjb25zdCBrZXkgPSBwcmVmaXggPyBgJHtwcmVmaXh9WyR7cHJvcH1dYCA6IHByb3A7XG4gICAgaWYgKHR5cGVvZiBvYmpbcHJvcF0gPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIHBhcmFtcy5hcHBlbmQoa2V5LCBzZXJpYWxpemUob2JqW3Byb3BdLCBrZXkpLnRvU3RyaW5nKCkpO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYXJhbXMuYXBwZW5kKGtleSwgb2JqW3Byb3BdKTtcbiAgICB9XG4gIH0pO1xuXG4gIHJldHVybiBwYXJhbXM7XG59XG5cbmZ1bmN0aW9uIHNlcmlhbGl6ZUZvcm1EYXRhKGRhdGE6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBGb3JtRGF0YSB7XG4gIHJldHVybiBPYmplY3QuZW50cmllcyhkYXRhKS5yZWR1Y2UoKGZkLCBba2V5LCB2YWx1ZV0pID0+IHtcbiAgICBmZC5hcHBlbmQoa2V5LCB2YWx1ZSk7XG4gICAgcmV0dXJuIGZkO1xuICB9LCBuZXcgRm9ybURhdGEoKSk7XG59XG5cbmZ1bmN0aW9uIHBhcnNlVXJsKHVybDogc3RyaW5nLCBvcHRpb25zOiBSZXF1ZXN0T3B0aW9uc1dpdGhVcmxzKSB7XG4gIGNvbnN0IHVybFdpdGhvdXRTbGFzaCA9IHVybC5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpLnRyaW0oKTtcbiAgY29uc3QgdSA9IC9eaHR0cHM/L2dpLnRlc3QodXJsV2l0aG91dFNsYXNoKSA/IHVybFdpdGhvdXRTbGFzaCA6IGAke29wdGlvbnMudXJscy5iYXNlfSR7dXJsV2l0aG91dFNsYXNofWA7XG5cbiAgaWYgKGlzTm9kZUpzICYmIHR5cGVvZiBvcHRpb25zLnVybHMubm9kZSA9PT0gXCJzdHJpbmdcIikge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy51cmxzLmFwaSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIG5ldyBVUkwodS5yZXBsYWNlKG9wdGlvbnMudXJscy5hcGksIG9wdGlvbnMudXJscy5ub2RlKSk7XG4gICAgfVxuXG4gICAgaWYgKCEvXmh0dHBzPy9naS50ZXN0KHUpKSB7XG4gICAgICByZXR1cm4gbmV3IFVSTCh1LCBvcHRpb25zLnVybHMubm9kZSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKC9eaHR0cHM/L2dpLnRlc3QodSkpIHtcbiAgICByZXR1cm4gbmV3IFVSTCh1KTtcbiAgfVxuXG4gIHJldHVybiBuZXcgVVJMKHUsIG9wdGlvbnMudXJscy5iYXNlKTtcbn1cblxuY29uc3QgZGVmYXVsdE9wdGlvbnM6IFJlcXVlc3RPcHRpb25zID0geyBhbGxvd2VkTWV0aG9kczogW1wiZ2V0XCIsIFwicG9zdFwiLCBcInB1dFwiLCBcInBhdGNoXCIsIFwiZGVsZXRlXCIsIFwiaGVhZFwiLCBcIm9wdGlvbnNcIl0gfTtcblxuLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIHNvbmFyanMvY29nbml0aXZlLWNvbXBsZXhpdHlcbmZ1bmN0aW9uIFJlcXVlc3RlcihiYXNlVXJsID0gXCJcIiwgb3B0aW9uczogUmVxdWVzdE9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucykge1xuICBjb25zdCB1cmwgPSBiYXNlVXJsLnJlcGxhY2UoL1xcLyQvZ2ksIFwiXCIpLnRyaW0oKTtcbiAgaWYgKCFvcHRpb25zLnVybHMpIHtcbiAgICBvcHRpb25zLnVybHMgPSB7XG4gICAgICBiYXNlOiBcIlwiLFxuICAgICAgbm9kZTogbnVsbCxcbiAgICAgIGFwaTogbnVsbFxuICAgIH07XG4gIH1cblxuICBpZiAoIW9wdGlvbnMuYWxsb3dlZE1ldGhvZHMpIHtcbiAgICBvcHRpb25zLmFsbG93ZWRNZXRob2RzID0gZGVmYXVsdE9wdGlvbnMuYWxsb3dlZE1ldGhvZHM7XG4gIH1cblxuICBjb25zdCBvcHRzOiBSZXF1ZXN0T3B0aW9uc1dpdGhVcmxzID0ge1xuICAgIC4uLihvcHRpb25zIGFzIFJlcXVlc3RPcHRpb25zV2l0aFVybHMpLFxuICAgIHVybHM6IHtcbiAgICAgIG5vZGU6IG9wdGlvbnMudXJscy5ub2RlIHx8IG51bGwsXG4gICAgICBhcGk6IG9wdGlvbnMudXJscy5hcGkgfHwgbnVsbCxcbiAgICAgIGJhc2U6IG9wdGlvbnMudXJscy5iYXNlID8gb3B0aW9ucy51cmxzLmJhc2UgKyB1cmwgOiB1cmxcbiAgICB9XG4gIH07XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNvbXBsZXhpdHlcbiAgY29uc3QgcmVxdWVzdCA9IGFzeW5jIGZ1bmN0aW9uIHJlcXVlc3QoXG4gICAgbWV0aG9kOiBzdHJpbmcsXG4gICAgdXJsOiBzdHJpbmcsXG4gICAgZGF0YT86IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsLFxuICAgIG9wdGlvbnM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fVxuICApIHtcbiAgICBjb25zdCBpbm5lck9wdGlvbnM6IFNlbmRPcHRpb25zID0ge1xuICAgICAgbWV0aG9kOiBtZXRob2QudG9VcHBlckNhc2UoKSxcbiAgICAgIGhlYWRlcnM6IHt9LFxuICAgICAgcmVzb2x2ZVdpdGhGdWxsUmVzcG9uc2U6IGZhbHNlLFxuICAgICAgLi4ub3B0cyxcbiAgICAgIC4uLm9wdGlvbnNcbiAgICB9IGFzIFNlbmRPcHRpb25zO1xuXG4gICAgaW5uZXJPcHRpb25zLmhlYWRlcnMgPSB7IC4uLmlubmVyT3B0aW9ucy5oZWFkZXJzLCAuLi5vcHRzLmhlYWRlcnMsIC4uLm9wdGlvbnMuaGVhZGVycyB9O1xuXG4gICAgaWYgKCFpbm5lck9wdGlvbnMuaGVhZGVycy5BY2NlcHQpIHtcbiAgICAgIGlubmVyT3B0aW9ucy5oZWFkZXJzLkFjY2VwdCA9IFwiYXBwbGljYXRpb24vanNvblwiO1xuICAgIH1cblxuICAgIGNvbnN0IGFjY2VwdFR5cGUgPSBpbm5lck9wdGlvbnMuaGVhZGVycy5BY2NlcHQ7XG4gICAgY29uc3QgY29udGVudFR5cGUgPSBpbm5lck9wdGlvbnMuaGVhZGVyc1tcIkNvbnRlbnQtVHlwZVwiXSB8fCBpbm5lck9wdGlvbnMuaGVhZGVyc1tcImNvbnRlbnQtdHlwZVwiXSB8fCBcIlwiO1xuXG4gICAgaWYgKCFpbm5lck9wdGlvbnMuYWxsb3dlZE1ldGhvZHMuaW5jbHVkZXMobWV0aG9kKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBNZXRob2QgJHttZXRob2R9IG5vdCBhbGxvd2VkLiBBbGxvd2VkIG1ldGhvZHM6ICR7aW5uZXJPcHRpb25zLmFsbG93ZWRNZXRob2RzLmpvaW4oXCIsIFwiKX1gKTtcbiAgICB9XG5cbiAgICBsZXQgZmluYWxVcmw6IFVSTDtcbiAgICB0cnkge1xuICAgICAgZmluYWxVcmwgPSBwYXJzZVVybCh1cmwsIG9wdHMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBwYXJzZSBVUkw6ICR7dXJsfWApO1xuICAgIH1cblxuICAgIGlmIChkYXRhKSB7XG4gICAgICBjb25zdCBpc0pzb24gPSAvanNvbi9naS50ZXN0KGNvbnRlbnRUeXBlKTtcblxuICAgICAgaWYgKGlubmVyT3B0aW9ucy5tZXRob2QgPT09IFwiR0VUXCIgJiYgdHlwZW9mIGRhdGEgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgZmluYWxVcmwuc2VhcmNoID0gc2VyaWFsaXplKGRhdGEpLnRvU3RyaW5nKCk7XG4gICAgICB9IGVsc2UgaWYgKGlubmVyT3B0aW9ucy5tZXRob2QgIT09IFwiR0VUXCIpIHtcbiAgICAgICAgaW5uZXJPcHRpb25zLmJvZHkgPSBpc0pzb24gPyBKU09OLnN0cmluZ2lmeShkYXRhKSA6IHNlcmlhbGl6ZUZvcm1EYXRhKGRhdGEpO1xuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZmluYWxVcmwudG9TdHJpbmcoKSwgaW5uZXJPcHRpb25zKTtcbiAgICBsZXQgYm9keSA9IG51bGw7XG4gICAgaWYgKCFyZXNwb25zZS5vaykge1xuICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKGAke3Jlc3BvbnNlLnN0YXR1c306ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gKSBhcyBFcnJvciAmIHsgcmVzcG9uc2U/OiBhbnk7IGJvZHk/OiBhbnkgfTtcbiAgICAgIGVyci5yZXNwb25zZSA9IHJlc3BvbnNlO1xuICAgICAgaWYgKC90ZXh0L2dpLnRlc3QoYWNjZXB0VHlwZSkpIHtcbiAgICAgICAgZXJyLmJvZHkgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgICB9XG5cbiAgICAgIGlmICgvanNvbi9naS50ZXN0KGFjY2VwdFR5cGUpKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgZXJyLmJvZHkgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgZXJyLmJvZHkgPSBudWxsO1xuICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgICAgY29uc29sZS53YXJuKFwiRmFpbGVkIHRvIHBhcnNlIEpTT04gcmVzcG9uc2U6XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aHJvdyBlcnI7XG4gICAgfVxuXG4gICAgaWYgKGlubmVyT3B0aW9ucy5yZXNvbHZlV2l0aEZ1bGxSZXNwb25zZSkge1xuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH1cblxuICAgIGlmICgvdGV4dC9naS50ZXN0KGFjY2VwdFR5cGUpKSB7XG4gICAgICBib2R5ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIH0gZWxzZSBpZiAoL2pzb24vZ2kudGVzdChhY2NlcHRUeXBlKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgYm9keSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgICAgIGNvbnNvbGUud2FybihcIkZhaWxlZCB0byBwYXJzZSBKU09OIHJlc3BvbnNlOlwiLCBlcnJvcik7XG4gICAgICAgIGJvZHkgPSBudWxsO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoL2Jsb2IvZ2kudGVzdChhY2NlcHRUeXBlKSkge1xuICAgICAgYm9keSA9IGF3YWl0IHJlc3BvbnNlLmJsb2IoKTtcbiAgICB9IGVsc2UgaWYgKC9hcnJheWJ1ZmZlci9naS50ZXN0KGFjY2VwdFR5cGUpKSB7XG4gICAgICBib2R5ID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKTtcbiAgICB9IGVsc2Uge1xuICAgICAgYm9keSA9IHJlc3BvbnNlO1xuICAgIH1cblxuICAgIHJldHVybiBib2R5IHx8IHJlc3BvbnNlO1xuICB9IGFzIHVua25vd24gYXMgUmVxdWVzdEludGVyZmFjZTtcblxuICByZXF1ZXN0Lm5ldyA9IChiYXNlVXJsOiBzdHJpbmcsIG9wdGlvbnM/OiBSZXF1ZXN0T3B0aW9ucykgPT4gUmVxdWVzdGVyKGJhc2VVcmwsIHsgLi4ub3B0cywgLi4uKG9wdGlvbnMgfHwge30pIH0pO1xuXG4gIHJlcXVlc3Quc2V0T3B0aW9uID0gKGtleTogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XG4gICAgc2V0KG9wdHMsIGtleSwgdmFsdWUpO1xuICAgIHJldHVybiBvcHRzO1xuICB9O1xuXG4gIHJlcXVlc3QuZ2V0T3B0aW9ucyA9IChrZXk/OiBzdHJpbmcpID0+IHtcbiAgICBpZiAoa2V5KSB7XG4gICAgICByZXR1cm4gZ2V0KG9wdHMsIGtleSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG9wdHM7XG4gIH07XG5cbiAgT2JqZWN0LmFzc2lnbihcbiAgICByZXF1ZXN0LFxuICAgIG9wdHMuYWxsb3dlZE1ldGhvZHMucmVkdWNlKChhY2M6IFJlY29yZDxzdHJpbmcsIGFueT4sIG1ldGhvZCkgPT4ge1xuICAgICAgYWNjW21ldGhvZF0gPSAodXJsOiBzdHJpbmcsIGRhdGE/OiBSZWNvcmQ8c3RyaW5nLCBhbnk+IHwgbnVsbCwgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT4pID0+XG4gICAgICAgIHJlcXVlc3QobWV0aG9kLCB1cmwsIGRhdGEsIG9wdGlvbnMpO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSlcbiAgKTtcblxuICByZXR1cm4gcmVxdWVzdDtcbn1cblxuZXhwb3J0IGNvbnN0IHJlcXVlc3QgPSBSZXF1ZXN0ZXIoKTtcbiJdLCJtYXBwaW5ncyI6ImdKQUFBQSxFQUFBLEcseURBQUFDLENBQUFELEVBQUEsQ0FBQUUsUUFBQSxJQUFBQSxJQUFBLEksRUFBQUMsRyxFQUFBSCxFLDBNQUFBSSxFQUF5QkMsUUFBQSxlQUN6QkMsRUFBeUJELFFBQUEscUJBcUR6QixTQUFTRSxFQUFVQyxFQUEwQkMsRUFBaUIsSUFDNUQsTUFBTUMsRUFBUyxJQUFJQyxnQkFXbkIsT0FUQUMsT0FBT0MsS0FBS0wsR0FBS00sUUFBU0MsSUFDeEIsTUFBTUMsRUFBTVAsRUFBUyxHQUFHQSxLQUFVTSxLQUFVQSxFQUNuQixpQkFBZFAsRUFBSU8sR0FDYkwsRUFBT08sT0FBT0QsRUFBS1QsRUFBVUMsRUFBSU8sR0FBT0MsR0FBS0UsWUFFN0NSLEVBQU9PLE9BQU9ELEVBQUtSLEVBQUlPLEdBQ3pCLEdBR0tMLENBQ1QsQ0E4QkEsSUFBTVMsRUFBaUMsQ0FBRUMsZUFBZ0IsQ0FBQyxNQUFPLE9BQVEsTUFBTyxRQUFTLFNBQVUsT0FBUSxZQWlKcEcsSUFBTWxCLEVBOUliLFNBQVNtQixFQUFVQyxFQUFVLEdBQUlDLEVBQTBCSixHQUN6RCxNQUFNSyxFQUFNRixFQUFRRyxRQUFRLFFBQVMsSUFBSUMsT0FDcENILEVBQVFJLE9BQ1hKLEVBQVFJLEtBQU8sQ0FDYkMsS0FBTSxHQUNOQyxLQUFNLEtBQ05DLElBQUssT0FJSlAsRUFBUUgsaUJBQ1hHLEVBQVFILGVBQWlCRCxFQUFlQyxnQkFHMUMsTUFBTVcsRUFBK0IsSUFDL0JSLEVBQ0pJLEtBQU0sQ0FDSkUsS0FBTU4sRUFBUUksS0FBS0UsTUFBUSxLQUMzQkMsSUFBS1AsRUFBUUksS0FBS0csS0FBTyxLQUN6QkYsS0FBTUwsRUFBUUksS0FBS0MsS0FBT0wsRUFBUUksS0FBS0MsS0FBT0osRUFBTUEsSUFLbER0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