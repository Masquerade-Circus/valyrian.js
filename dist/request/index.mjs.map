{
  "version": 3,
  "sources": ["../../lib/request/index.ts"],
  "sourcesContent": ["import { isNodeJs } from \"valyrian.js\";\nimport { createContextScope, getContext, isServerContextActive, setContext } from \"valyrian.js/context\";\nimport { get, isObject, isString, set } from \"valyrian.js/utils\";\n\ninterface UrlOptions {\n  base?: string;\n  node?: string | null;\n  api?: string | null;\n}\n\ninterface RequestOptions {\n  allowedMethods?: string[];\n  urls?: UrlOptions;\n  [key: string | number | symbol]: any;\n}\n\ninterface RequestOptionsWithUrls extends RequestOptions {\n  urls: UrlOptions;\n  allowedMethods: string[];\n}\n\ninterface SendOptions extends RequestOptionsWithUrls, RequestInit {\n  allowedMethods: string[];\n  method: string;\n  headers: Record<string, string>;\n  resolveWithFullResponse?: boolean;\n}\n\nexport interface RequestPlugin {\n  name?: string;\n  request?: (ctx: RequestContext) => RequestContext | Promise<RequestContext | void> | void;\n  response?: (ctx: ResponseContext) => ResponseContext | Promise<ResponseContext | void> | void;\n  error?: (ctx: ErrorContext) => ErrorContext | Promise<ErrorContext | void> | void;\n}\n\nexport interface RequestContext {\n  method: string;\n  url: URL;\n  data?: Record<string, any> | null;\n  options: SendOptions;\n}\n\nexport interface ResponseContext extends RequestContext {\n  response: Response;\n  body: any;\n}\n\nexport interface ErrorContext extends RequestContext {\n  response?: Response;\n  error: any;\n  body?: any;\n}\n\nexport interface RequestInterface {\n  // eslint-disable-next-line no-unused-vars\n  (method: string, url: string, data?: Record<string, any> | null, options?: Partial<SendOptions>): any | Response;\n  // eslint-disable-next-line no-unused-vars\n  new: (baseUrl: string, options?: RequestOptions) => RequestInterface;\n  // eslint-disable-next-line no-unused-vars\n  use: (plugin: RequestPlugin) => number;\n  // eslint-disable-next-line no-unused-vars\n  eject: (pluginId: number) => void;\n  // eslint-disable-next-line no-unused-vars\n  setOption: (key: string, value: any) => RequestOptions;\n  // eslint-disable-next-line no-unused-vars\n  setOptions: (values: Record<string, any>) => RequestOptions;\n  // eslint-disable-next-line no-unused-vars\n  getOption: (key: string) => any;\n  // eslint-disable-next-line no-unused-vars\n  getOptions: (key?: string) => RequestOptions | void;\n  // eslint-disable-next-line no-unused-vars\n  get: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  // eslint-disable-next-line no-unused-vars\n  post: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  // eslint-disable-next-line no-unused-vars\n  put: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  // eslint-disable-next-line no-unused-vars\n  patch: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  // eslint-disable-next-line no-unused-vars\n  delete: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  // eslint-disable-next-line no-unused-vars\n  head: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  // eslint-disable-next-line no-unused-vars\n  options: (url: string, data?: Record<string, any> | null, options?: Record<string, any>) => any | Response;\n  [key: string | number | symbol]: any;\n}\n\nfunction serialize(obj: any, prefix?: string): URLSearchParams {\n  if (obj === null || obj === undefined) {\n    return new URLSearchParams();\n  }\n\n  const params = new URLSearchParams();\n  Object.keys(obj).forEach((prop) => {\n    const key = prefix ? `${prefix}[${prop}]` : prop;\n    if (typeof obj[prop] === \"object\" && obj[prop] !== null) {\n      const nestedParams = serialize(obj[prop], key);\n      nestedParams.forEach((value, nestedKey) => params.append(nestedKey, value));\n      return;\n    }\n    params.append(key, obj[prop]);\n  });\n  return params;\n}\n\nfunction serializeFormData(data: Record<string, any>): FormData {\n  const fd = new FormData();\n  Object.entries(data).forEach(([key, value]) => {\n    if (value === null || value === undefined) {\n      return;\n    }\n    if (Array.isArray(value)) {\n      value.forEach((v) => fd.append(key, v));\n    } else {\n      fd.append(key, value);\n    }\n  });\n  return fd;\n}\n\nfunction parseUrl(url: string, options: RequestOptionsWithUrls) {\n  const urlWithoutSlash = url.replace(/\\/+$/g, \"\").trim();\n  const u = /^https?/gi.test(urlWithoutSlash) ? urlWithoutSlash : `${options.urls.base || \"\"}${urlWithoutSlash}`;\n\n  if (isNodeJs && isString(options.urls.node)) {\n    if (isString(options.urls.api)) {\n      return new URL(u.replace(options.urls.api, options.urls.node));\n    }\n    if (!/^https?/gi.test(u)) {\n      return new URL(u, options.urls.node);\n    }\n  }\n\n  if (/^https?/gi.test(u)) {\n    return new URL(u);\n  }\n\n  if (!isNodeJs) {\n    return new URL(u, window.location.origin);\n  }\n\n  return new URL(u);\n}\n\nconst defaultOptions: RequestOptions = {\n  allowedMethods: [\"get\", \"post\", \"put\", \"patch\", \"delete\", \"head\", \"options\"]\n};\n\nconst requestContextScope = createContextScope<RequestInterface>(\"request\");\n\nconst isNativeBody = (data: any) =>\n  data instanceof FormData ||\n  data instanceof URLSearchParams ||\n  data instanceof Blob ||\n  data instanceof ArrayBuffer ||\n  (typeof DataView !== \"undefined\" && data instanceof DataView) ||\n  (typeof ReadableStream !== \"undefined\" && data instanceof ReadableStream);\n\nfunction Requester(baseUrl = \"\", options: RequestOptions = defaultOptions, isRoot = false) {\n  const url = baseUrl.replace(/\\/$/gi, \"\").trim();\n  if (!options.urls) {\n    options.urls = {\n      base: \"\",\n      node: null,\n      api: null\n    };\n  }\n\n  if (!options.allowedMethods) {\n    options.allowedMethods = defaultOptions.allowedMethods;\n  }\n\n  const opts: RequestOptionsWithUrls = {\n    ...(options as RequestOptionsWithUrls),\n    urls: {\n      node: options.urls.node || null,\n      api: options.urls.api || null,\n      base: options.urls.base ? options.urls.base + url : url\n    }\n  };\n\n  const plugins = new Map<number, RequestPlugin>();\n  let pluginId = 0;\n\n  function getContextualRequest() {\n    if (!isRoot || !isNodeJs) {\n      return null;\n    }\n\n    const contextual = getContext(requestContextScope);\n    if (!contextual || contextual === request) {\n      return null;\n    }\n\n    return contextual;\n  }\n\n  const applyRequestPlugins = async (ctx: RequestContext) => {\n    let nextCtx = ctx;\n    for (const plugin of plugins.values()) {\n      if (!plugin.request) {\n        continue;\n      }\n      const maybe = await plugin.request(nextCtx);\n      if (maybe) {\n        nextCtx = maybe;\n      }\n    }\n    return nextCtx;\n  };\n\n  const applyResponsePlugins = async (ctx: ResponseContext) => {\n    let nextCtx = ctx;\n    for (const plugin of plugins.values()) {\n      if (!plugin.response) {\n        continue;\n      }\n      const maybe = await plugin.response(nextCtx);\n      if (maybe) {\n        nextCtx = maybe;\n      }\n    }\n    return nextCtx;\n  };\n\n  const applyErrorPlugins = async (ctx: ErrorContext) => {\n    let nextCtx = ctx;\n    for (const plugin of plugins.values()) {\n      if (!plugin.error) {\n        continue;\n      }\n      const maybe = await plugin.error(nextCtx);\n      if (maybe) {\n        nextCtx = maybe;\n      }\n    }\n    return nextCtx;\n  };\n\n  const request = async function request(\n    method: string,\n    url: string,\n    data?: Record<string, any> | null,\n    options: Record<string, any> = {}\n  ) {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest(method, url, data, options);\n    }\n\n    const innerOptions: SendOptions = {\n      method: method.toUpperCase(),\n      headers: {},\n      resolveWithFullResponse: false,\n      ...opts,\n      ...options\n    } as SendOptions;\n\n    innerOptions.headers = {\n      ...innerOptions.headers,\n      ...opts.headers,\n      ...options.headers\n    };\n    if (!innerOptions.headers.Accept) {\n      innerOptions.headers.Accept = \"application/json\";\n    }\n\n    if (!innerOptions.allowedMethods.includes(method)) {\n      throw new Error(`Method ${method} not allowed. Allowed methods: ${innerOptions.allowedMethods.join(\", \")}`);\n    }\n\n    let finalUrl: URL;\n    try {\n      finalUrl = parseUrl(url, opts);\n    } catch (error) {\n      const err = new Error(`Failed to parse URL: ${url}`, { cause: error });\n      err.cause = error;\n      throw err;\n    }\n\n    let requestContext = await applyRequestPlugins({\n      method,\n      url: finalUrl,\n      data,\n      options: innerOptions\n    });\n\n    finalUrl = requestContext.url;\n\n    const acceptType = requestContext.options.headers.Accept;\n    const contentType =\n      requestContext.options.headers[\"Content-Type\"] || requestContext.options.headers[\"content-type\"] || \"\";\n\n    if (requestContext.data) {\n      if (requestContext.options.method === \"GET\" && typeof requestContext.data === \"object\") {\n        const params = new URLSearchParams(finalUrl.search);\n        serialize(requestContext.data).forEach((value, key) => params.append(key, value));\n        finalUrl.search = params.toString();\n      } else if (isNativeBody(requestContext.data) || isString(requestContext.data)) {\n        requestContext.options.body = requestContext.data as BodyInit;\n      } else {\n        const isJson = /json/gi.test(contentType);\n        requestContext.options.body = isJson\n          ? JSON.stringify(requestContext.data)\n          : serializeFormData(requestContext.data);\n      }\n    }\n\n    try {\n      const response = await fetch(finalUrl.toString(), requestContext.options);\n\n      if (!response.ok) {\n        const err = new Error(`${response.status}: ${response.statusText}`) as Error & {\n          response?: any;\n          body?: any;\n        };\n        err.response = response;\n        if (/text/gi.test(acceptType)) {\n          err.body = await response.text();\n        } else if (/json/gi.test(acceptType)) {\n          try {\n            err.body = await response.json();\n          } catch {\n            err.body = null;\n          }\n        }\n\n        const errorContext = await applyErrorPlugins({\n          ...requestContext,\n          response,\n          body: err.body,\n          error: err\n        });\n\n        const normalizedError = errorContext.error as any;\n        if (isObject(normalizedError)) {\n          (normalizedError as any).__requestPluginHandled = true;\n        }\n        throw normalizedError;\n      }\n\n      if (requestContext.options.resolveWithFullResponse) {\n        return response;\n      }\n\n      let body: any = response;\n      if (/text/gi.test(acceptType)) {\n        body = await response.text();\n      } else if (/json/gi.test(acceptType)) {\n        try {\n          body = await response.json();\n        } catch {\n          body = null;\n        }\n      } else if (/blob/gi.test(acceptType)) {\n        body = await response.blob();\n      } else if (/arraybuffer/gi.test(acceptType)) {\n        body = await response.arrayBuffer();\n      }\n\n      const responseContext = await applyResponsePlugins({\n        ...requestContext,\n        response,\n        body\n      });\n\n      return responseContext.body;\n    } catch (error: any) {\n      if (error && (error.response || error.__requestPluginHandled)) {\n        throw error;\n      }\n      const errorContext = await applyErrorPlugins({\n        ...requestContext,\n        error\n      });\n      const normalizedError = errorContext.error as any;\n      if (isObject(normalizedError)) {\n        (normalizedError as any).__requestPluginHandled = true;\n      }\n      throw normalizedError;\n    }\n  } as unknown as RequestInterface;\n\n  request.new = (baseUrl: string, options?: RequestOptions) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest.new(baseUrl, options);\n    }\n\n    const next = Requester(baseUrl, { ...opts, ...(options || {}) });\n    plugins.forEach((plugin) => next.use(plugin));\n\n    if (isRoot && isServerContextActive()) {\n      setContext(requestContextScope, next);\n    }\n\n    return next;\n  };\n\n  request.use = (plugin: RequestPlugin) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest.use(plugin);\n    }\n\n    pluginId += 1;\n    plugins.set(pluginId, plugin);\n    return pluginId;\n  };\n\n  request.eject = (id: number) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      contextualRequest.eject(id);\n      return;\n    }\n\n    plugins.delete(id);\n  };\n\n  request.setOption = (key: string, value: any) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest.setOption(key, value);\n    }\n\n    set(opts, key, value);\n    return opts;\n  };\n\n  request.setOptions = (values: Record<string, any>) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest.setOptions(values);\n    }\n\n    for (const key of Object.keys(values)) {\n      set(opts, key, values[key]);\n    }\n    return opts;\n  };\n\n  request.getOption = (key: string) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest.getOption(key);\n    }\n    return get(opts, key);\n  };\n\n  request.getOptions = (key?: string) => {\n    const contextualRequest = getContextualRequest();\n    if (contextualRequest) {\n      return contextualRequest.getOptions(key);\n    }\n\n    if (key) {\n      return get(opts, key);\n    }\n    return opts;\n  };\n\n  Object.assign(\n    request,\n    opts.allowedMethods.reduce((acc: Record<string, any>, method) => {\n      acc[method] = (url: string, data?: Record<string, any> | null, options?: Record<string, any>) =>\n        request(method, url, data, options);\n      return acc;\n    }, {})\n  );\n\n  return request;\n}\n\nexport const request = Requester(\"\", defaultOptions, true);\n"],
  "mappings": "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",
  "names": ["request", "url", "options", "baseUrl"]
}
