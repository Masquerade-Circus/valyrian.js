(()=>{"use strict";var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,o=Object.prototype.hasOwnProperty,s={};((t,r)=>{for(var o in r)e(t,o,{get:r[o],enumerable:!0})})(s,{StorageType:()=>c,createNativeStore:()=>d});var a,n=(a=s,((s,a,n,i)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let l of r(a))o.call(s,l)||l===n||e(s,l,{get:()=>a[l],enumerable:!(i=t(a,l))||i.enumerable});return s})(e({},"__esModule",{value:!0}),a)),i=require("valyrian.js"),l=require("valyrian.js/context"),c=(e=>(e.Session="session",e.Local="local",e))(c||{}),y=new Map,u=(0,l.createContextScope)("native-store.registry");function d(e,t={},r="local",o=!1){const s=function(e){if(i.isNodeJs&&"undefined"==typeof localStorage)throw new Error('localStorage and sessionStorage are not available in Node.js, to use it in your project, you need to "import "valyrian.js/node"');return"session"===e?sessionStorage:localStorage}(r),a=function(){if(!i.isNodeJs||!(0,l.isServerContextActive)())return y;let e=(0,l.getContext)(u);return e||(e=new Map,(0,l.setContext)(u,e)),e}();if(a.has(e)){if(o)return console.warn(`Store with key ${e} already exists and will be reused`),a.get(e);throw new Error(`Store with key ${e} already exists`)}const n={state:{},set(t,r){try{this.state[t]=r,s.setItem(e,JSON.stringify(this.state))}catch(e){console.error("Error setting item in storage:",e)}},get(e){return 0===Object.keys(this.state).length&&this.load(),this.state[e]},delete(t){try{Reflect.deleteProperty(this.state,t),s.setItem(e,JSON.stringify(this.state))}catch(e){console.error("Error deleting item in storage:",e)}},load(){try{const t=s.getItem(e);if(!t)return this.state={},void s.setItem(e,JSON.stringify(this.state));this.state=JSON.parse(t)}catch(e){console.error("Error loading state from storage:",e),this.state={}}},clear(){try{this.state={},s.removeItem(e)}catch(e){console.error("Error clearing storage:",e)}},...t};if(!i.isNodeJs&&"local"===r){let t=function(t){if(t.key===e)try{n.state=null===t.newValue?{}:JSON.parse(t.newValue)}catch(t){console.error(`Error syncing store ${e} from storage event`,t)}};window.addEventListener("storage",t)}return n.load(),a.set(e,n),n}"undefined"!=typeof module?module.exports=n:self.ValyrianNativeStore=n})();//# sourceMappingURL=index.min.js.map