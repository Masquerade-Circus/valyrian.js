!function(){"use strict";var e=function(n,t){if(void 0===t&&(t=[]),"function"==typeof n)return t.push(n),t;for(var r=0,o=n.length;r<o;r++)Array.isArray(n[r])&&e(n[r],t),Array.isArray(n[r])||t.push(n[r]);return t},n=function(t,r,o){var i,a;if("string"==typeof o[0]&&(i=o.shift()),"function"==typeof o[0]&&void 0!==o[0].paths&&void 0!==o[0].regexpList)for(var s=o.shift(),c=0,u=s.paths.length;c<u;c++){var d=s.paths[c].middlewares,l=s.paths[c].method,p=s.paths[c].path;void 0!==i&&(p=i+(p||"*")),void 0!==p&&d.unshift(p),t=n(t,l,d)}if((a=e(o)).length>0){if(void 0!==i&&void 0===t.regexpList[i]){var h=(i=i.replace(/\/(\?.*)?$/gi,"$1")).match(/:(\w+)?/gi)||[];for(var f in h)h[f]=h[f].replace(":","");var v=i.replace(/:(\w+)/gi,"([^\\s\\/|\\?]+)").replace(/\*/g,".*").replace(/\/(\?.*)?$/gi,"$1");t.regexpList[i]={regexp:RegExp("^"+v+"/?(\\?.*)?$","gi"),params:h}}t.paths.push({method:r,path:i,middlewares:a})}return t},t=function(){var t=async function(n){void 0===n&&(n="/");var r,o={},i=[],a=0,s=t.paths.length;for(t.url=n;a<s;a++){var c=t.paths[a];if("get"===c.method||"use"===c.method)if("use"!==c.method&&"get"!==c.method||void 0!==c.path){var u=t.regexpList[c.path].regexp.exec(n);if(t.regexpList[c.path].regexp.lastIndex=-1,Array.isArray(u)){u.shift();for(var d=t.regexpList[c.path].params.length;d--;)void 0===o[t.regexpList[c.path].params[d]]&&(o[t.regexpList[c.path].params[d]]=u[d]);i=e(c.middlewares,i)}}else i=e(c.middlewares,i)}if(t.params=o,i.length>0)for(var l=0,p=i.length;l<p;l++)if(void 0!==(r=await i[l](o)))return r;if(t.throwNotFound)throw Error("The url "+n+" requested wasn't found")};return t.url="/",t.params={},t.throwNotFound=!0,t.paths=[],t.regexpList={},["get","use"].map(function(e){t[e]=function(){for(var r=[],o=arguments.length;o--;)r[o]=arguments[o];return n(t,e,r)}}),t},r=function(){for(var e=[],n=arguments.length;n--;)e[n]=arguments[n];var t,o,i,a={name:"div",props:{},children:[]};if("string"==typeof e[0]&&e[0].trim().length>0&&(a.name=e.shift()),"textNode"===a.name)return a.value=e.join(" ").trim(),a;if(r.isVnode(e[0])||"object"!=typeof e[0]||Array.isArray(e[0])||null===e[0]||(a.props=e.shift()),/(\.|\[|#)/gi.test(a.name)&&(i=a.name.match(/([\.|\#]\w+|\[[^\]]+\])/gi),a.name=a.name.replace(/([\.|\#]\w+|\[[^\]]+\])/gi,""),i))for(t=i.length;t--;)"#"!==i[t].charAt(0)?"."!==i[t].charAt(0)?"["===i[t].charAt(0)&&(i[t]=i[t].trim().slice(1,-1).split("="),a.props[i[t][0]]=i[t][1]):a.props.class=((a.props.class||"")+" "+i[t].slice(1)).trim():a.props.id=i[t].slice(1);for(o=0,t=e.length;o<t;o++)if(Array.isArray(e[o]))for(var s=0,c=e[o].length;s<c;s++)a.children.push(r.isVnode(e[o][s])?e[o][s]:r("textNode",e[o][s]));else a.children.push(r.isVnode(e[o])?e[o]:r("textNode",e[o]));return a};r.isVnode=function(e){return e&&e.name&&e.props&&e.children},r.vnode=function(e){if(e)return 3===e.nodeType?{value:e.nodeValue,name:"textNode",props:{},children:[],dom:e}:{name:e.nodeName.toLowerCase(),props:{},children:Array.prototype.map.call(e.childNodes,function(e){return r.vnode(e)}),dom:e}};var o=function(e,n){void 0===e&&(e=""),void 0===n&&(n={});var t=e.replace(/\/$/gi,"").trim(),r=Object.assign({},n),i=function(e,n){var t=i.baseUrl+"/"+e,r=Object.assign({},i.options,n);return o(t,r)};i.apiUrl=void 0,i.nodeUrl=void 0,i.isNode="undefined"==typeof window,i.options=r,i.baseUrl=t;var a=i.isNode?require("node-fetch"):fetch.bind(window);function s(e,n,t,r){void 0===r&&(r={});var o=Object.assign({method:e.toLowerCase(),headers:{Accept:"application/json","Content-Type":"application/json"}},i.options,r),s=o.headers.Accept;return void 0!==t&&("get"===o.method&&"object"==typeof t&&(n+=t=function e(n,t){var r=encodeURIComponent;return"?"+Object.keys(n).map(function(o){return void 0!==t&&(o=t+"["+o+"]"),"object"==typeof n[o]?e(n[o],o):r(o)+"="+r(n[o])}).join("&")}(t)),"get"!==o.method&&(o.body=JSON.stringify(t))),a(function(e){var n=(i.baseUrl+"/"+e).trim().replace(/^\/\//gi,"/").trim();return i.isNode&&"string"==typeof i.nodeUrl&&(i.nodeUrl=i.nodeUrl.replace(/\/$/gi,"").trim(),/^http/gi.test(n)&&"string"==typeof i.apiUrl&&(i.apiUrl=i.apiUrl.replace(/\/$/gi,"").trim(),n=n.replace(i.apiUrl,i.nodeUrl)),/^http/gi.test(n)||(n=i.nodeUrl+n)),n}(n),o).then(function(e){if(e.status<200||e.status>300){var n=Error(e.statusText);throw n.response=e,n}return/text/gi.test(s)?e.text():/json/gi.test(s)?e.json():e})}return["get","post","put","patch","delete","options","head"].forEach(function(e){return i[e]=function(n,t,r){return s(e,n,t,r)}}),i},i=o(),a=function(){var e=function(){for(var n=[],t=arguments.length;t--;)n[t]=arguments[t];return e.isComponent(n[0])?e.render.apply(e,n):r.apply(r,n)};e.domReady=function(e){c(document,/https?:\/\//.test(window.document.URL)?"DOMContentLoaded":"deviceready",e,!1)},e.request=i,Object.keys(i).forEach(function(n){"function"==typeof i[n]&&(e[n]=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return i[n].apply(i,t).then(function(n){return e.update(),n})})}),e.router=t,e.isVnode=r.isVnode,e.vnode=r.vnode,e.isDomElement=r.isDomElement,e.isNode="undefined"==typeof window,e.window=e.isNode?require("html-element"):window,e.document=e.window.document;var n=function(e){var n=e.document;function t(e,n,t){"className"!==n?"function"!=typeof t?("boolean"==typeof t&&(e[n]=t),void 0!==t&&!1!==t?e.setAttribute(n,t):e.removeAttribute(n)):e[n]=t.bind(e):e.setAttribute("class",t)}function r(e,n){void 0===n&&(n={});var r=e.props,o=n.props||{},i=Object.assign({},r,o);for(var a in i)r[a]!==o[a]&&t(e.dom,a,r[a])}async function o(n,t){for(var r=[],o=arguments.length-2;o-- >0;)r[o]=arguments[o+2];if(e.isVnode(n)){var i=n.props[t];if(i&&i.call)return r.unshift(n),await i.apply(n,r)}}function i(e){var t;delete e.dom,o(e,"oninit"),t="textNode"===e.name?n.createTextNode(e.value):"svg"===e.name?n.createElementNS("http://www.w3.org/2000/svg",e.name):n.createElement(e.name),e.dom=t,r(e);for(var a=0;a<e.children.length;a++)t.appendChild(i(e.children[a]));return o(e,"oncreate"),t}function a(e,n){return void 0===n&&(n=!1),Promise.resolve(o(e,"onbeforeremove")).then(function(){!n&&e.dom&&e.dom.parentElement&&e.dom.parentElement.removeChild(e.dom);for(var t=0,r=e.children.length;t<r;t++)a(e.children[t],n);o(e,"onremove")})}return function n(t,s,c){if(void 0===c&&void 0!==s)return t.appendChild(i(s)),t;if(void 0===s)return a(c),t;if(e.isVnode(c)&&e.isVnode(s)){if(s.dom=c.dom,"textNode"===s.name&&c.value==s.value)return t;if("textNode"===s.name&&s.value!=c.value||s.name!==c.name)return i(s),Promise.resolve(a(c,!0)).then(function(){t.replaceChild(s.dom,c.dom)}),t;r(s,c);for(var u=Math.max(s.children.length,c.children.length),d=0;d<u;d++)n(s.dom,s.children[d],c.children[d]);return o(s,"onupdate"),t}return t}}(e);function o(){e.isMounted=!1,e.container=e.document.createElement("html"),e.parent=e.document.createElement("div"),e.parent.appendChild(e.container),e.rootTree=e.vnode(e.container),e.oldTree=Object.assign({},e.rootTree)}function s(e,n){void 0===n&&(n={}),e.attributes=n.name&&n.props&&Array.isArray(n.children)?{children:n}:Array.isArray(n)?{children:1===n.length?n[0]:n}:Object.assign({},e.attributes,n)}function c(n,t,r,o){e.isNode||t.split(" ").forEach(function(e){n.addEventListener(e,r,o)})}function u(t,r){return void 0===r&&(r={}),e.isComponent(t)&&(s(t,r),e.rootComponent=t,e.rootTree.props={},Object.keys(e.rootComponent).forEach(function(n){"function"==typeof e.rootComponent[n]&&(e.rootTree.props[n]=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return e.rootComponent[n].apply(e.rootComponent,t)})})),e.rootComponent&&(e.isNode&&o(),e.rootTree.children=e.render(e.rootComponent),n(e.rootTree.dom.parentElement,e.rootTree,e.oldTree),e.oldTree=Object.assign({},e.rootTree),e.isMounted||(e.isMounted=!0)),e.isNode?require("he").decode(e.rootTree.dom.parentElement.innerHTML):e.rootTree.dom.parentElement}return o(),e.rootComponent=void 0,e.render=function(n,t){if(void 0===t&&(t={}),!e.isComponent(n))throw Error("A component is required");return s(n,t),function e(n,t){if(void 0===t&&(t=[]),!Array.isArray(n))return t.push(n),t;for(var r=0,o=n.length;r<o;r++)Array.isArray(n[r])&&e(n[r],t),Array.isArray(n[r])||t.push(n[r]);return t}(n.view())},e.mount=function(n,t,r){if(void 0===r&&(r={}),void 0===n)throw Error("A container element is required as first element");if(!e.isComponent(t))throw Error("A component is required as a second argument");return!e.isNode&&e.container&&function(n,t,r){e.isNode||t.split(" ").forEach(function(e){n.removeEventListener(e,r)})}(e.container,"mouseup keyup",e.update),e.container=e.isNode?e.document.createElement("div"):"string"==typeof n?e.document.querySelectorAll(n)[0]:n,e.rootTree=e.vnode(e.container),e.oldTree=Object.assign({},e.rootTree),e.isNode||c(e.container,"mouseup keyup",e.update,!1),e.update(t,r)},e.update=function(n,t){if(void 0===t&&(t={}),e.isNode)return u(n,t);requestAnimationFrame(function(){return u(n,t)})},e.isComponent=function(e){return"object"==typeof e&&null!==e&&"function"==typeof e.view},e.routes=function(n,t){if(n&&t)return e.routes.router=t,e.routes.container=n,void e.routes.init();var r=[];return e.routes.router.paths.forEach(function(e){"get"===e.method&&r.push(""===e.path?"/":e.path)}),r},e.routes.run=async function(n,t){void 0===n&&(n="/"),void 0===t&&(t=void 0);var r=await e.routes.router(n);if(!e.isComponent(r)){var o=r;r={view:function(){return o}}}if(t){var i=r;r={view:function(){return e(t,e(i))}}}return e.isNode||!e.isMounted?e.mount(e.routes.container,r,{params:e.routes.router.params}):e.update(r,{params:e.routes.router.params})},e.routes.go=function(n,t){return e.isNode||window.history.pushState({},"",n),e.routes.run(n,t)},e.routes.init=function(){e.isNode||(c(window,"popstate",function(n){e.routes.run(document.location.pathname)},!1),e.domReady(function(){e.routes.run(document.location.pathname)}))},e.isNode||(e.sw={ready:!1,file:"/sw.js",options:{scope:"/"},register:function(n,t){void 0===n&&(n=e.sw.file),void 0===t&&(t=e.sw.options),navigator.serviceWorker.register(n,t).then(function(){return navigator.serviceWorker.ready}).then(function(r){return e.sw.ready=!0,e.sw.file=n,e.sw.options=t,new Promise(function(e,n){setTimeout(function(){e()},10)})}).catch(function(e){return console.error("ServiceWorker registration failed: ",e)})}}),e.isNode&&function(e){var n=require("fs"),t=require("uncss");function r(){var e="";return function(t){if(!t)return e;e+=n.readFileSync(t,"utf8")}}e.inline={css:r(),js:r(),uncss:function(n,r){return void 0===r&&(r={}),r.raw=e.inline.css(),Promise.all(n).then(function(e){return new Promise(function(n,o){t(e,r,function(e,t){e&&o(e),n(t)})})})}},e.sw={create:function(e,t){void 0===t&&(t={});var r=Object.assign({version:"v1::",name:"Valyrian.js",urls:["/"],debug:!1},t),o="let Log = console.log;\n\nlet config = {\n    version: 'v1::',\n    name: 'Valyrian.js',\n    urls: ['/']\n};\n\n// Function to add the network response to the cache\nlet fetchedFromNetwork = event => response => {\n    Log('WORKER: fetch response from network.', event.request.url);\n    if (!response || response.status !== 200 || response.type !== 'basic') {\n        return;\n    }\n\n    let cacheCopy = response.clone();\n    caches\n      .open(config.version + config.name)\n      .then(cache => cache.put(event.request, cacheCopy))\n      .then(() => Log('WORKER: fetch response stored in cache.', event.request.url));\n    return response;\n};\n\n// If the network or the cache response fail, response with Service Unavailable\nlet unableToResolve = () => {\n    Log('WORKER: fetch request failed in both cache and network.');\n    return new Response('<h1>Service Unavailable</h1>', {\n        status: 503,\n        statusText: 'Service Unavailable',\n        headers: new Headers({\n            'Content-Type': 'text/html'\n        })\n    });\n};\n\n// Fetch listener\nself.addEventListener(\"fetch\", event => {\n    Log('WORKER: fetch event in progress.', event.request.url);\n\n    let url = new URL(event.request.url);\n\n    // We only handle Get requests all others let them pass\n    if (event.request.method !== 'GET') {\n        return;\n    }\n\n    // TODO: Make a callback available here to filter if this request must be catched or let it pass directly\n    // This callback must return true or false\n\n    Log('WORKER: fetchevent for ' + url);\n\n    event.respondWith(\n        caches.match(event.request).then(cached => {\n            Log('WORKER: fetch event', cached ? '(cached)' : '(network)', event.request.url);\n\n            let network = fetch(event.request)\n                .then(fetchedFromNetwork(event), unableToResolve)\n                .catch(error => {\n                    console.log(error);\n                    return caches.match('/');\n                });\n\n            return network || cached;\n        })\n    );\n});\n\nself.addEventListener(\"install\", event => {\n    event.waitUntil(\n        // We can't use cache.add() here, since we want OFFLINE_URL to be the cache key, but\n        // the actual URL we end up requesting might include a cache-busting parameter.\n        caches.open(config.version + config.name)\n            .then(cache => cache.addAll(config.urls))\n            .catch(error => console.error('WORKER: Failed to cache', error))\n    );\n});\n\nself.addEventListener(\"activate\", event => {\n    event.waitUntil(\n        caches.keys()\n            .then(keys => Promise.all(\n                keys.filter(key => !key.startsWith(config.version)) // Filter by keys that don't start with the latest version prefix.\n                    .map(key => caches.delete(key)) // Return a promise that's fulfilled when each outdated cache is deleted.\n            ))\n            .then(() => self.clients.claim())\n    );\n});".replace("v1::","v"+r.version+"::").replace("Valyrian.js",r.name).replace("['/']",'["'+r.urls.join('","')+'"]');r.debug||(o=o.replace("console.log","() => {}")),n.writeFileSync(e,o,"utf8")}}}(e),e.new=a,e};("undefined"==typeof window?global:window).v=a()}();
//# sourceMappingURL=valyrian.min.js.map
