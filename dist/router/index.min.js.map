//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJyb3V0ZXJfZXhwb3J0cyIsIl9fZXhwb3J0IiwiUm91dGVyIiwiZGVmYXVsdCIsInJvdXRlcl9kZWZhdWx0IiwibG9jYWxWYWx5cmlhbiIsIl9fRVhQT1JUU19fIiwiYWRkUGF0aCIsInJvdXRlciIsIm1ldGhvZCIsInBhdGgiLCJtaWRkbGV3YXJlcyIsImxlbmd0aCIsInJlYWxwYXRoIiwicmVwbGFjZSIsInBhcmFtcyIsIm1hdGNoIiwicGFyYW0iLCJzbGljZSIsInJlZ2V4cFBhdGgiLCJhcnJheSIsInBhdGhzIiwicHVzaCIsIkFycmF5IiwiaXNBcnJheSIsImZsYXQiLCJJbmZpbml0eSIsInJlZ2V4cCIsIlJlZ0V4cCIsImNvbnRhaW5lciIsInF1ZXJ5Iiwib3B0aW9ucyIsInVybCIsIm1hdGNoZXMiLCJhZGQiLCJhcmdzIiwidGhpcyIsInVzZSIsImkiLCJrIiwic3Vicm91dGVyIiwiaXRlbSIsInN1YnBhdGgiLCJzaGlmdCIsInJvdXRlcyIsImZvckVhY2giLCJhc3luYyIsInBhcmVudENvbXBvbmVudCIsIkVycm9yIiwicGFydHMiLCJzcGxpdCIsInVybFBhcnRzIiwicXVlcnlQYXJ0cyIsIm5hbWVWYWx1ZSIsInBhcnNlUXVlcnkiLCJrZXkiLCJleGVjIiwic2VhcmNoTWlkZGxld2FyZXMiLCJjb21wb25lbnQiLCJyZXNwb25zZSIsInJlcSIsInJlZGlyZWN0IiwiZ28iLCJpc0NvbXBvbmVudCIsInNlYXJjaENvbXBvbmVudCIsImNoaWxkQ29tcG9uZW50IiwiaXNWbm9kZUNvbXBvbmVudCIsImNoaWxkcmVuIiwiaXNOb2RlSnMiLCJ3aW5kb3ciLCJoaXN0b3J5IiwicHVzaFN0YXRlIiwiaXNNb3VudGVkIiwidXBkYXRlIiwibW91bnQiLCJnZXRPbkNsaWNrSGFuZGxlciIsImUiLCJwcmV2ZW50RGVmYXVsdCIsInYiLCJtb3VudFJvdXRlciIsImVsZW1lbnRDb250YWluZXIiLCJyb3V0ZXJPckNvbXBvbmVudCIsImJpbmQiLCJvblBvcFN0YXRlR29Ub1JvdXRlIiwiZG9jdW1lbnQiLCJsb2NhdGlvbiIsInBhdGhuYW1lIiwiYWRkRXZlbnRMaXN0ZW5lciIsImRpcmVjdGl2ZSIsInZub2RlIiwib2xkbm9kZSIsInNldEF0dHJpYnV0ZSJdLCJzb3VyY2VzIjpbIi4uLy4uL2xpYi9yb3V0ZXIvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tdXNlLWJlZm9yZS1kZWZpbmUgKi9cbmltcG9ydCB7IENvbXBvbmVudCwgVmFseXJpYW4sIFZhbHlyaWFuQ29tcG9uZW50LCBWbm9kZUNvbXBvbmVudEludGVyZmFjZSB9IGZyb20gXCJWYWx5cmlhblwiO1xuXG5pbnRlcmZhY2UgUGF0aCB7XG4gIG1ldGhvZDogc3RyaW5nO1xuICBwYXRoOiBzdHJpbmc7XG4gIG1pZGRsZXdhcmVzOiBNaWRkbGV3YXJlcztcbiAgcGFyYW1zOiBzdHJpbmdbXTtcbiAgcmVnZXhwOiBSZWdFeHA7XG59XG5cbmludGVyZmFjZSBSZXF1ZXN0IHtcbiAgcGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCBhbnk+O1xuICBxdWVyeTogUmVjb3JkPHN0cmluZywgYW55PjtcbiAgdXJsOiBzdHJpbmc7XG4gIHBhdGg6IHN0cmluZztcbiAgbWF0Y2hlczogc3RyaW5nW107XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICByZWRpcmVjdDogKHBhdGg6IHN0cmluZywgcGFyZW50Q29tcG9uZW50PzogQ29tcG9uZW50IHwgVmFseXJpYW5Db21wb25lbnQgfCBWbm9kZUNvbXBvbmVudEludGVyZmFjZSkgPT4gZmFsc2U7XG59XG5cbmludGVyZmFjZSBNaWRkbGV3YXJlIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIChyZXE6IFJlcXVlc3QsIHJlcz86IGFueSk6IFByb21pc2U8YW55IHwgQ29tcG9uZW50IHwgVmFseXJpYW5Db21wb25lbnQgfCBWbm9kZUNvbXBvbmVudEludGVyZmFjZT47XG59XG5cbmludGVyZmFjZSBNaWRkbGV3YXJlcyBleHRlbmRzIEFycmF5PE1pZGRsZXdhcmU+IHt9XG5cbmludGVyZmFjZSBSb3V0ZXJJbnRlcmZhY2Uge1xuICBwYXRoczogUGF0aFtdO1xuICBjb250YWluZXI6IEVsZW1lbnQgfCBzdHJpbmcgfCBudWxsO1xuICBxdWVyeTogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVtYmVyPjtcbiAgb3B0aW9uczogUmVjb3JkPHN0cmluZywgYW55PjtcbiAgdXJsOiBzdHJpbmc7XG4gIHBhdGg6IHN0cmluZztcbiAgcGFyYW1zOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBudW1iZXIgfCBhbnk+O1xuICBtYXRjaGVzOiBzdHJpbmdbXTtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIGFkZChtZXRob2Q6IHN0cmluZywgLi4uYXJnczogTWlkZGxld2FyZXMpOiBSb3V0ZXI7XG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby11bnVzZWQtdmFyc1xuICB1c2UoLi4uYXJnczogTWlkZGxld2FyZXMgfCBSb3V0ZXJbXSk6IFJvdXRlcjtcbiAgcm91dGVzKCk6IHN0cmluZ1tdO1xuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnNcbiAgZ28ocGF0aDogc3RyaW5nLCBwYXJlbnRDb21wb25lbnQ/OiBDb21wb25lbnQgfCBWYWx5cmlhbkNvbXBvbmVudCB8IFZub2RlQ29tcG9uZW50SW50ZXJmYWNlKTogUHJvbWlzZTxzdHJpbmcgfCB2b2lkPjtcbn1cblxubGV0IGxvY2FsVmFseXJpYW46IFZhbHlyaWFuO1xuXG5mdW5jdGlvbiBmbGF0KGFycmF5OiBhbnkpIHtcbiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoYXJyYXkpID8gYXJyYXkuZmxhdChJbmZpbml0eSkgOiBbYXJyYXldO1xufVxuXG5sZXQgYWRkUGF0aCA9IChyb3V0ZXI6IFJvdXRlciwgbWV0aG9kOiBzdHJpbmcsIHBhdGg6IHN0cmluZywgbWlkZGxld2FyZXM6IGFueVtdKSA9PiB7XG4gIGlmIChtaWRkbGV3YXJlcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgcmVhbHBhdGggPSBwYXRoLnJlcGxhY2UoLyhcXFMpKFxcLyspJC8sIFwiJDFcIik7XG5cbiAgLy8gRmluZCB0aGUgZXhwcmVzcyBsaWtlIHBhcmFtc1xuICBsZXQgcGFyYW1zID0gcmVhbHBhdGgubWF0Y2goLzooXFx3Kyk/L2dpKSB8fCBbXTtcblxuICAvLyBTZXQgdGhlIG5hbWVzIG9mIHRoZSBwYXJhbXMgZm91bmRcbiAgZm9yIChsZXQgcGFyYW0gaW4gcGFyYW1zKSB7XG4gICAgcGFyYW1zW3BhcmFtXSA9IHBhcmFtc1twYXJhbV0uc2xpY2UoMSk7XG4gIH1cblxuICBsZXQgcmVnZXhwUGF0aCA9IFwiXlwiICsgcmVhbHBhdGgucmVwbGFjZSgvOihcXHcrKS9naSwgXCIoW15cXFxcL1xcXFxzXSspXCIpICsgXCIkXCI7XG5cbiAgcm91dGVyLnBhdGhzLnB1c2goe1xuICAgIG1ldGhvZCxcbiAgICBwYXRoOiByZWFscGF0aCxcbiAgICBtaWRkbGV3YXJlczogZmxhdChtaWRkbGV3YXJlcyksXG4gICAgcGFyYW1zLFxuICAgIHJlZ2V4cDogbmV3IFJlZ0V4cChyZWdleHBQYXRoLCBcImlcIilcbiAgfSk7XG59O1xuXG5mdW5jdGlvbiBwYXJzZVF1ZXJ5KHF1ZXJ5UGFydHM/OiBzdHJpbmcpIHtcbiAgbGV0IHBhcnRzID0gcXVlcnlQYXJ0cyA/IHF1ZXJ5UGFydHMuc3BsaXQoXCImXCIsIDIwKSA6IFtdO1xuICBsZXQgcXVlcnk6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgbGV0IGkgPSAwO1xuICBsZXQgbmFtZVZhbHVlO1xuXG4gIGZvciAoOyBpIDwgcGFydHMubGVuZ3RoOyBpKyspIHtcbiAgICBuYW1lVmFsdWUgPSBwYXJ0c1tpXS5zcGxpdChcIj1cIiwgMik7XG4gICAgcXVlcnlbbmFtZVZhbHVlWzBdXSA9IG5hbWVWYWx1ZVsxXTtcbiAgfVxuXG4gIHJldHVybiBxdWVyeTtcbn1cblxuZnVuY3Rpb24gc2VhcmNoTWlkZGxld2FyZXMocm91dGVyOiBSb3V0ZXJJbnRlcmZhY2UsIHBhdGg6IHN0cmluZyk6IE1pZGRsZXdhcmVzIHtcbiAgbGV0IGk7XG4gIGxldCBrO1xuICBsZXQgaXRlbTtcbiAgbGV0IG1hdGNoO1xuICBsZXQga2V5O1xuICBsZXQgbWlkZGxld2FyZXM6IE1pZGRsZXdhcmVzID0gW107XG4gIGxldCBwYXJhbXM6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fTtcbiAgbGV0IG1hdGNoZXMgPSBbXTtcbiAgcm91dGVyLnBhcmFtcyA9IHt9O1xuICByb3V0ZXIucGF0aCA9IFwiXCI7XG4gIHJvdXRlci5tYXRjaGVzID0gW107XG5cbiAgLy8gU2VhcmNoIGZvciBtaWRkbGV3YXJlc1xuICBmb3IgKGkgPSAwOyBpIDwgcm91dGVyLnBhdGhzLmxlbmd0aDsgaSsrKSB7XG4gICAgaXRlbSA9IHJvdXRlci5wYXRoc1tpXTtcblxuICAgIG1hdGNoID0gaXRlbS5yZWdleHAuZXhlYyhwYXRoKTtcbiAgICAvLyBJZiB3ZSBmb3VuZCBtaWRkbGV3YXJlc1xuICAgIGlmIChBcnJheS5pc0FycmF5KG1hdGNoKSkge1xuICAgICAgbWlkZGxld2FyZXMucHVzaCguLi5pdGVtLm1pZGRsZXdhcmVzKTtcbiAgICAgIG1hdGNoLnNoaWZ0KCk7XG5cbiAgICAgIC8vIFBhcnNlIHBhcmFtc1xuICAgICAgZm9yIChrID0gMDsgayA8IGl0ZW0ucGFyYW1zLmxlbmd0aDsgaysrKSB7XG4gICAgICAgIGtleSA9IGl0ZW0ucGFyYW1zW2tdO1xuICAgICAgICBwYXJhbXNba2V5XSA9IG1hdGNoLnNoaWZ0KCk7XG4gICAgICB9XG5cbiAgICAgIHdoaWxlIChtYXRjaC5sZW5ndGgpIHtcbiAgICAgICAgbWF0Y2hlcy5wdXNoKG1hdGNoLnNoaWZ0KCkgYXMgc3RyaW5nKTtcbiAgICAgIH1cblxuICAgICAgaWYgKGl0ZW0ubWV0aG9kID09PSBcImFkZFwiKSB7XG4gICAgICAgIHJvdXRlci5wYXRoID0gaXRlbS5wYXRoO1xuICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICByb3V0ZXIucGFyYW1zID0gcGFyYW1zO1xuICByb3V0ZXIubWF0Y2hlcyA9IG1hdGNoZXM7XG5cbiAgcmV0dXJuIG1pZGRsZXdhcmVzO1xufVxuXG5hc3luYyBmdW5jdGlvbiBzZWFyY2hDb21wb25lbnQoXG4gIHJvdXRlcjogUm91dGVySW50ZXJmYWNlLFxuICBtaWRkbGV3YXJlczogTWlkZGxld2FyZXNcbik6IFByb21pc2U8Q29tcG9uZW50IHwgVmFseXJpYW5Db21wb25lbnQgfCBWbm9kZUNvbXBvbmVudEludGVyZmFjZSB8IGZhbHNlIHwgdm9pZD4ge1xuICBsZXQgcmVzcG9uc2U7XG4gIGxldCByZXE6IFJlcXVlc3QgPSB7XG4gICAgcGFyYW1zOiByb3V0ZXIucGFyYW1zLFxuICAgIHF1ZXJ5OiByb3V0ZXIucXVlcnksXG4gICAgdXJsOiByb3V0ZXIudXJsLFxuICAgIHBhdGg6IHJvdXRlci5wYXRoLFxuICAgIG1hdGNoZXM6IHJvdXRlci5tYXRjaGVzLFxuICAgIHJlZGlyZWN0OiAocGF0aDogc3RyaW5nLCBwYXJlbnRDb21wb25lbnQ/OiBDb21wb25lbnQgfCBWYWx5cmlhbkNvbXBvbmVudCB8IFZub2RlQ29tcG9uZW50SW50ZXJmYWNlKSA9PiB7XG4gICAgICByb3V0ZXIuZ28ocGF0aCwgcGFyZW50Q29tcG9uZW50KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gIH07XG4gIGxldCBpID0gMDtcblxuICBmb3IgKDsgaSA8IG1pZGRsZXdhcmVzLmxlbmd0aDsgaSsrKSB7XG4gICAgcmVzcG9uc2UgPSBhd2FpdCBtaWRkbGV3YXJlc1tpXShyZXEsIHJlc3BvbnNlKTtcblxuICAgIGlmIChyZXNwb25zZSAhPT0gdW5kZWZpbmVkICYmIGxvY2FsVmFseXJpYW4uaXNDb21wb25lbnQocmVzcG9uc2UpKSB7XG4gICAgICByZXR1cm4gcmVzcG9uc2U7XG4gICAgfVxuXG4gICAgaWYgKHJlc3BvbnNlID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgUm91dGVyIGltcGxlbWVudHMgUm91dGVySW50ZXJmYWNlIHtcbiAgcGF0aHM6IFBhdGhbXSA9IFtdO1xuICBjb250YWluZXI6IEVsZW1lbnQgfCBzdHJpbmcgfCBudWxsID0gbnVsbDtcbiAgcXVlcnk6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bWJlcj4gPSB7fTtcbiAgb3B0aW9uczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICB1cmw6IHN0cmluZyA9IFwiXCI7XG4gIHBhdGg6IHN0cmluZyA9IFwiXCI7XG4gIHBhcmFtczogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVtYmVyIHwgYW55PiA9IHt9O1xuICBtYXRjaGVzOiBzdHJpbmdbXSA9IFtdO1xuXG4gIGFkZChwYXRoOiBzdHJpbmcsIC4uLmFyZ3M6IE1pZGRsZXdhcmVzKTogUm91dGVyIHtcbiAgICBhZGRQYXRoKHRoaXMsIFwiYWRkXCIsIHBhdGgsIGFyZ3MpO1xuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgdXNlKC4uLmFyZ3M6IE1pZGRsZXdhcmVzIHwgUm91dGVyW10pOiBSb3V0ZXIge1xuICAgIGxldCBwYXRoID0gdHlwZW9mIGFyZ3NbMF0gPT09IFwic3RyaW5nXCIgPyBhcmdzLnNoaWZ0KCkgOiBcIi9cIjtcbiAgICBsZXQgaTtcbiAgICBsZXQgaztcbiAgICBsZXQgc3Vicm91dGVyO1xuICAgIGxldCBpdGVtO1xuICAgIGxldCBzdWJwYXRoO1xuXG4gICAgZm9yIChpID0gMDsgaSA8IGFyZ3MubGVuZ3RoOyBpKyspIHtcbiAgICAgIHN1YnJvdXRlciA9IGFyZ3NbaV07XG4gICAgICBpZiAodHlwZW9mIHN1YnJvdXRlciA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIGFkZFBhdGgodGhpcywgXCJ1c2VcIiwgYCR7cGF0aH0uKmAsIFtzdWJyb3V0ZXJdKTtcbiAgICAgIH0gZWxzZSBpZiAoc3Vicm91dGVyLnBhdGhzKSB7XG4gICAgICAgIGZvciAoayA9IDA7IGsgPCBzdWJyb3V0ZXIucGF0aHMubGVuZ3RoOyBrKyspIHtcbiAgICAgICAgICBpdGVtID0gc3Vicm91dGVyLnBhdGhzW2tdO1xuICAgICAgICAgIHN1YnBhdGggPSBgJHtwYXRofSR7aXRlbS5wYXRofWAucmVwbGFjZSgvXlxcL1xcLy8sIFwiL1wiKTtcbiAgICAgICAgICBhZGRQYXRoKHRoaXMsIGl0ZW0ubWV0aG9kLCBzdWJwYXRoLCBpdGVtLm1pZGRsZXdhcmVzKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgcm91dGVzKCkge1xuICAgIGxldCByb3V0ZXM6IHN0cmluZ1tdID0gW107XG4gICAgdGhpcy5wYXRocy5mb3JFYWNoKChwYXRoKSA9PiB7XG4gICAgICBpZiAocGF0aC5tZXRob2QgPT09IFwiYWRkXCIpIHtcbiAgICAgICAgcm91dGVzLnB1c2gocGF0aC5wYXRoKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXR1cm4gcm91dGVzO1xuICB9XG5cbiAgYXN5bmMgZ28ocGF0aDogc3RyaW5nLCBwYXJlbnRDb21wb25lbnQ/OiBDb21wb25lbnQgfCBWYWx5cmlhbkNvbXBvbmVudCk6IFByb21pc2U8c3RyaW5nIHwgdm9pZD4ge1xuICAgIGlmICghcGF0aCkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKFwicm91dGVyLnVybC5yZXF1aXJlZFwiKTtcbiAgICB9XG5cbiAgICBsZXQgcGFydHMgPSBwYXRoLnNwbGl0KFwiP1wiLCAyKTtcbiAgICBsZXQgdXJsUGFydHMgPSBwYXJ0c1swXS5yZXBsYWNlKC8oLispXFwvJC8sIFwiJDFcIik7XG4gICAgbGV0IHF1ZXJ5UGFydHMgPSBwYXJ0c1sxXTtcbiAgICB0aGlzLnVybCA9IHBhdGg7XG4gICAgdGhpcy5xdWVyeSA9IHBhcnNlUXVlcnkocXVlcnlQYXJ0cyk7XG5cbiAgICBsZXQgbWlkZGxld2FyZXMgPSBzZWFyY2hNaWRkbGV3YXJlcyh0aGlzLCB1cmxQYXJ0cyk7XG5cbiAgICBsZXQgY29tcG9uZW50ID0gYXdhaXQgc2VhcmNoQ29tcG9uZW50KHRoaXMsIG1pZGRsZXdhcmVzKTtcblxuICAgIGlmIChjb21wb25lbnQgPT09IGZhbHNlKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgaWYgKCFjb21wb25lbnQpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHVybCAke3BhdGh9IHJlcXVlc3RlZCB3YXNuJ3QgZm91bmRgKTtcbiAgICB9XG5cbiAgICBpZiAobG9jYWxWYWx5cmlhbi5pc0NvbXBvbmVudChwYXJlbnRDb21wb25lbnQpKSB7XG4gICAgICBsZXQgY2hpbGRDb21wb25lbnQgPSBsb2NhbFZhbHlyaWFuLmlzVm5vZGVDb21wb25lbnQoY29tcG9uZW50KSA/IGNvbXBvbmVudCA6IGxvY2FsVmFseXJpYW4oY29tcG9uZW50LCB7fSk7XG4gICAgICBpZiAobG9jYWxWYWx5cmlhbi5pc1Zub2RlQ29tcG9uZW50KHBhcmVudENvbXBvbmVudCkpIHtcbiAgICAgICAgcGFyZW50Q29tcG9uZW50LmNoaWxkcmVuLnB1c2goY2hpbGRDb21wb25lbnQpO1xuICAgICAgICBjb21wb25lbnQgPSBwYXJlbnRDb21wb25lbnQ7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb21wb25lbnQgPSBsb2NhbFZhbHlyaWFuKHBhcmVudENvbXBvbmVudCwge30sIGNoaWxkQ29tcG9uZW50KSBhcyBWbm9kZUNvbXBvbmVudEludGVyZmFjZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIWxvY2FsVmFseXJpYW4uaXNOb2RlSnMpIHtcbiAgICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBcIlwiLCBwYXRoKTtcbiAgICB9XG5cbiAgICBpZiAobG9jYWxWYWx5cmlhbi5pc01vdW50ZWQgJiYgbG9jYWxWYWx5cmlhbi5jb21wb25lbnQgPT09IGNvbXBvbmVudCkge1xuICAgICAgcmV0dXJuIGxvY2FsVmFseXJpYW4udXBkYXRlKCk7XG4gICAgfVxuXG4gICAgaWYgKHRoaXMuY29udGFpbmVyKSB7XG4gICAgICByZXR1cm4gbG9jYWxWYWx5cmlhbi5tb3VudCh0aGlzLmNvbnRhaW5lciwgY29tcG9uZW50KTtcbiAgICB9XG4gIH1cblxuICBnZXRPbkNsaWNrSGFuZGxlcih1cmw6IHN0cmluZykge1xuICAgIHJldHVybiAoZTogTW91c2VFdmVudCkgPT4ge1xuICAgICAgaWYgKHR5cGVvZiB1cmwgPT09IFwic3RyaW5nXCIgJiYgdXJsLmxlbmd0aCA+IDApIHtcbiAgICAgICAgdGhpcy5nbyh1cmwpO1xuICAgICAgfVxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG4gIH1cbn1cblxuZGVjbGFyZSBtb2R1bGUgXCJWYWx5cmlhblwiIHtcbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gIGludGVyZmFjZSBWYWx5cmlhbiB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXVudXNlZC12YXJzXG4gICAgbW91bnRSb3V0ZXI/KGNvbnRhaW5lcjogRWxlbWVudCB8IHN0cmluZywgcm91dGVyOiBSb3V0ZXIpOiBzdHJpbmcgfCB2b2lkO1xuICB9XG59XG5cbmZ1bmN0aW9uIHBsdWdpbih2OiBWYWx5cmlhbikge1xuICBsb2NhbFZhbHlyaWFuID0gdjtcbiAgbG9jYWxWYWx5cmlhbi5tb3VudFJvdXRlciA9IChlbGVtZW50Q29udGFpbmVyLCByb3V0ZXJPckNvbXBvbmVudCkgPT4ge1xuICAgIGlmIChyb3V0ZXJPckNvbXBvbmVudCBpbnN0YW5jZW9mIFJvdXRlcikge1xuICAgICAgcm91dGVyT3JDb21wb25lbnQuY29udGFpbmVyID0gZWxlbWVudENvbnRhaW5lcjtcbiAgICAgIGxvY2FsVmFseXJpYW4ucmVkaXJlY3QgPSByb3V0ZXJPckNvbXBvbmVudC5nby5iaW5kKHJvdXRlck9yQ29tcG9uZW50KTtcblxuICAgICAgLy8gQWN0aXZhdGUgdGhlIHVzZSBvZiB0aGUgcm91dGVyXG4gICAgICBpZiAoIWxvY2FsVmFseXJpYW4uaXNOb2RlSnMpIHtcbiAgICAgICAgZnVuY3Rpb24gb25Qb3BTdGF0ZUdvVG9Sb3V0ZSgpIHtcbiAgICAgICAgICAocm91dGVyT3JDb21wb25lbnQgYXMgdW5rbm93biBhcyBSb3V0ZXIpLmdvKGRvY3VtZW50LmxvY2F0aW9uLnBhdGhuYW1lKTtcbiAgICAgICAgfVxuICAgICAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInBvcHN0YXRlXCIsIG9uUG9wU3RhdGVHb1RvUm91dGUsIGZhbHNlKTtcbiAgICAgICAgb25Qb3BTdGF0ZUdvVG9Sb3V0ZSgpO1xuICAgICAgfVxuXG4gICAgICBsb2NhbFZhbHlyaWFuLmRpcmVjdGl2ZShcInJvdXRlXCIsICh1cmwsIHZub2RlLCBvbGRub2RlKSA9PiB7XG4gICAgICAgIGxvY2FsVmFseXJpYW4uc2V0QXR0cmlidXRlKFwiaHJlZlwiLCB1cmwsIHZub2RlLCBvbGRub2RlKTtcbiAgICAgICAgbG9jYWxWYWx5cmlhbi5zZXRBdHRyaWJ1dGUoXCJvbmNsaWNrXCIsIHJvdXRlck9yQ29tcG9uZW50LmdldE9uQ2xpY2tIYW5kbGVyKHVybCksIHZub2RlLCBvbGRub2RlKTtcbiAgICAgIH0pO1xuICAgIH1cbiAgfTtcbiAgcmV0dXJuIFJvdXRlcjtcbn1cblxuZXhwb3J0IGRlZmF1bHQgcGx1Z2luO1xuIl0sIm1hcHBpbmdzIjoiZ0pBQUFBLEVBQUEsRyx5REFBQUMsQ0FBQUQsRUFBQSxDQUFBRSxPQUFBLElBQUFBLEVBQUFDLFFBQUEsSUFBQUMsSUFBQSxJLEVBOENJQyxFQTlDSkMsRyxFQUFBTixFLDBNQW9EQSxJQUFJTyxFQUFVLENBQUNDLEVBQWdCQyxFQUFnQkMsRUFBY0MsS0FDM0QsR0FBMkIsSUFBdkJBLEVBQVlDLE9BQ2QsT0FHRixJQUFJQyxFQUFXSCxFQUFLSSxRQUFRLGFB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