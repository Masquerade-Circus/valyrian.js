{
  "version": 3,
  "sources": ["../../lib/router/index.ts"],
  "sourcesContent": ["/* eslint-disable no-console */\n/* eslint-disable no-use-before-define */\nimport {\n  Component,\n  POJOComponent,\n  VnodeComponentInterface,\n  VnodeWithDom,\n  directive,\n  isComponent,\n  isNodeJs,\n  isVnodeComponent,\n  mount,\n  setAttribute,\n  v\n} from \"valyrian.js\";\n\ninterface Request {\n  params: Record<string, any>;\n  query: Record<string, any>;\n  url: string;\n  path: string;\n  matches: string[];\n  // eslint-disable-next-line no-unused-vars\n  redirect: (path: string) => Promise<string | void>;\n}\n\ninterface Middleware {\n  // eslint-disable-next-line no-unused-vars\n  (req: Request, err?: any):\n    | Promise<any | Component | POJOComponent | VnodeComponentInterface>\n    | any\n    | Component\n    | POJOComponent\n    | VnodeComponentInterface;\n}\n\ninterface Middlewares extends Array<Middleware> {}\n\ninterface RedirectFunction {\n  // eslint-disable-next-line no-unused-vars\n  (\n    path: string,\n    parentComponent?: Component | POJOComponent | VnodeComponentInterface,\n    preventPushState?: boolean\n  ): Promise<string | void>;\n}\n\nfunction flat(array: any) {\n  return Array.isArray(array) ? array.flat(Infinity) : [array];\n}\n\nfunction getPathWithoutPrefix(path: string, prefix: string) {\n  return getPathWithoutLastSlash(path.replace(new RegExp(`^${prefix}`), \"\"));\n}\n\nfunction getPathWithoutLastSlash(path: string) {\n  let pathWithoutLastSlash = path.replace(/\\/$/, \"\");\n  if (pathWithoutLastSlash === \"\") {\n    pathWithoutLastSlash = \"/\";\n  }\n  return pathWithoutLastSlash;\n}\n\n// Parse a query string into an object\nfunction parseQuery(queryParts?: string): Record<string, any> {\n  const parts = queryParts ? queryParts.split(\"&\") : [];\n  const query: Record<string, any> = {};\n\n  for (const nameValue of parts) {\n    const [name, value] = nameValue.split(\"=\", 2);\n    query[name] =\n      isNaN(Number(value)) === false ? Number(value) : value === \"true\" ? true : value === \"false\" ? false : value;\n  }\n\n  return query;\n}\n\ninterface RouteNode {\n  segment: string;\n  children: Map<string, RouteNode>;\n  middlewares?: Middlewares;\n  paramKey?: string;\n  isDynamic: boolean;\n}\n\nclass RouteTree {\n  root: RouteNode = { segment: \"\", children: new Map(), isDynamic: false };\n\n  addRoute(path: string, middlewares: Middlewares) {\n    const segments = path === \"/\" ? [path] : path.split(\"/\").filter(Boolean); // Divide the path into segments\n    let currentNode = this.root;\n\n    for (const segment of segments) {\n      const isDynamic = segment.startsWith(\":\");\n      const key = isDynamic ? \":\" : segment; // If the segment is dynamic, use \":\" as key\n\n      if (!currentNode.children.has(key)) {\n        currentNode.children.set(key, {\n          segment: segment,\n          children: new Map(),\n          isDynamic: isDynamic,\n          paramKey: isDynamic ? segment.slice(1) : undefined\n        });\n      }\n\n      currentNode = currentNode.children.get(key)!;\n    }\n\n    currentNode.middlewares = middlewares; // Assign the middlewares to the last node\n  }\n\n  // Search for a route in the tree\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  findRoute(path: string): { middlewares?: Middlewares; params: Record<string, string> } | null {\n    const pathWithoutLastSlash = getPathWithoutLastSlash(path);\n    const segments =\n      pathWithoutLastSlash === \"/\" ? [pathWithoutLastSlash] : pathWithoutLastSlash.split(\"/\").filter(Boolean);\n    let currentNode: RouteNode | null = this.root;\n    const params: Record<string, string> = {};\n\n    const wildcardMiddlewares: Middlewares = []; // Middlewares for wildcard routes\n    const segmentsLength = segments.length;\n\n    for (let i = 0; i < segmentsLength; i++) {\n      if (!currentNode) {\n        break;\n      }\n\n      const segment = segments[i];\n\n      let found = false;\n\n      for (const [key, child] of currentNode.children) {\n        if (key === segment) {\n          currentNode = child;\n          found = true;\n          break;\n        }\n\n        if (segment !== \".*\" && key === \":\") {\n          currentNode = child;\n          params[child.paramKey!] = segment;\n          found = true;\n          break;\n        }\n\n        if (key === \".*\" && !found) {\n          wildcardMiddlewares.push(...(child.middlewares || []));\n        }\n      }\n\n      if (!found) {\n        if (currentNode.children.has(\".*\")) {\n          return { middlewares: wildcardMiddlewares, params };\n        }\n        return null;\n      }\n    }\n\n    // Add the wildcard middlewares to the current node middlewares\n    const allMiddlewares = [...wildcardMiddlewares, ...(currentNode.middlewares || [])];\n\n    // If there are no middlewares, return null\n    if (allMiddlewares.length === 0) {\n      return null;\n    }\n\n    // If there are middlewares, return them\n    return { middlewares: allMiddlewares, params };\n  }\n}\n\nexport const RouterError = class RouterError extends Error {\n  status: number | undefined = 500;\n};\n\nexport class Router {\n  private routeTree = new RouteTree();\n  container: Element | string | null = null;\n  query: Record<string, string | number> = {};\n  options: Record<string, any> = {};\n  url: string = \"\";\n  path: string = \"\";\n  params: Record<string, string | number | any> = {};\n  matches: string[] = [];\n  pathPrefix: string = \"\";\n\n  private errorHandlers: Map<number | string | Error | \"generic\", Middlewares> = new Map();\n\n  constructor(pathPrefix: string = \"\") {\n    this.pathPrefix = pathPrefix;\n  }\n\n  add(...args: (string | Middleware | Router)[]): Router {\n    const flatArgs = flat(args);\n    const path = getPathWithoutLastSlash(\n      `${this.pathPrefix}${typeof flatArgs[0] === \"string\" ? flatArgs.shift() : \"/.*\"}`\n    );\n\n    // If the first argument is a Router, add all its routes\n    if (flatArgs.length === 1 && flatArgs[0] instanceof Router) {\n      const subrouter = flatArgs[0] as Router;\n      for (const subroute of subrouter.routes()) {\n        const subroutePath = `${path}${subroute}`;\n        this.routeTree.addRoute(subroutePath, subrouter.routeTree.findRoute(subroute)!.middlewares || []);\n      }\n    } else {\n      // Verify that no middlewares are added when a subrouter is added\n      if (flatArgs.some((item) => item instanceof Router)) {\n        throw new RouterError(\"You cannot add middlewares when adding a subrouter.\");\n      }\n\n      // Verify that all middlewares are functions\n      if (flatArgs.some((item) => typeof item !== \"function\")) {\n        throw new RouterError(\"All middlewares must be functions.\");\n      }\n\n      this.routeTree.addRoute(path, flatArgs as Middlewares);\n    }\n\n    return this;\n  }\n\n  catch(...args: (number | string | Error | Middleware)[]): Router {\n    const condition =\n      typeof args[0] === \"number\" || typeof args[0] === \"string\" || args[0].name.includes(\"Error\")\n        ? (args.shift() as number | string | Error)\n        : \"generic\";\n\n    if (typeof condition !== \"number\" && typeof condition !== \"string\" && !condition.name.includes(\"Error\")) {\n      throw new RouterError(\"The condition must be a number, string or an instance of Error.\");\n    }\n\n    // Verify that all middlewares are functions\n    if (args.some((item) => typeof item !== \"function\")) {\n      throw new RouterError(\"All middlewares must be functions.\");\n    }\n\n    let handlers = this.errorHandlers.get(condition);\n    if (!handlers) {\n      handlers = [];\n      this.errorHandlers.set(condition, handlers);\n    }\n\n    handlers.push(...(args as Middlewares));\n    return this;\n  }\n\n  routes(): string[] {\n    return this.getAllRoutes(this.routeTree.root, \"\");\n  }\n\n  async go(\n    path: string,\n    parentComponent?: Component | POJOComponent | VnodeComponentInterface\n  ): Promise<string | void> {\n    if (!path) {\n      return this.handleError(new RouterError(\"The URL is empty.\"), parentComponent);\n    }\n\n    if (/%[^0-9A-Fa-f]{2}/.test(path)) {\n      return this.handleError(new RouterError(`The URL ${path} is malformed.`));\n    }\n\n    const constructedPath = getPathWithoutLastSlash(`${this.pathPrefix}${path}`);\n    const parts = constructedPath.split(\"?\", 2);\n    this.url = constructedPath;\n    this.query = parseQuery(parts[1]);\n\n    const finalPath = parts[0].replace(/(.+)\\/$/, \"$1\").split(\"#\")[0];\n    this.path = path;\n\n    let route = this.routeTree.findRoute(finalPath);\n\n    if (!route || !route.middlewares) {\n      // If the route is not found, search for a wildcard route\n      const finalPathParts = finalPath.split(\"/\"); // Divide the path into segments\n\n      while (finalPathParts.length > 0) {\n        finalPathParts.pop(); // Remove the last segment\n        const wildcardRoute = this.routeTree.findRoute(finalPathParts.join(\"/\") + \"/.*\"); // Search for a wildcard route\n        if (wildcardRoute) {\n          route = wildcardRoute;\n          break;\n        }\n      }\n\n      // If no route is found, return a 404 error\n      if (!route || !route.middlewares) {\n        const error = new RouterError(`The URL ${constructedPath} was not found in the router's registered paths.`);\n        (error as any).status = 404;\n        return this.handleError(error, parentComponent);\n      }\n    }\n\n    const { middlewares, params } = route;\n    this.params = params;\n\n    let component = await this.searchComponent(middlewares, parentComponent);\n\n    if (component === false) {\n      return;\n    }\n\n    if (!component) {\n      return this.handleError(\n        new RouterError(`The URL ${constructedPath} did not return a valid component.`),\n        parentComponent\n      );\n    }\n\n    if (isComponent(parentComponent) || isVnodeComponent(parentComponent)) {\n      const childComponent = isVnodeComponent(component) ? component : v(component as Component, {});\n      if (isVnodeComponent(parentComponent)) {\n        parentComponent.children.push(childComponent);\n        component = parentComponent;\n      } else {\n        component = v(parentComponent, {}, childComponent) as VnodeComponentInterface;\n      }\n    }\n\n    if (!isNodeJs && window.location.pathname + window.location.search !== constructedPath) {\n      window.history.pushState(null, \"\", constructedPath);\n    }\n\n    if (this.container) {\n      return mount(this.container, component);\n    }\n  }\n\n  getOnClickHandler(url: string) {\n    return (e: MouseEvent) => {\n      if (e.button !== 0 || e.ctrlKey || e.metaKey || e.shiftKey || e.altKey || e.defaultPrevented) {\n        return;\n      }\n\n      if (typeof url === \"string\" && url.length > 0) {\n        this.go(url);\n      }\n      e.preventDefault();\n    };\n  }\n\n  private getAllRoutes(node: RouteNode, prefix: string): string[] {\n    const routes: string[] = [];\n\n    for (const [key, child] of node.children) {\n      // eslint-disable-next-line sonarjs/no-nested-template-literals\n      const newPrefix = `${prefix}/${child.isDynamic ? `:${child.paramKey}` : key}`.replace(/\\/$/, \"\");\n      if (child.middlewares) {\n        routes.push(newPrefix);\n      }\n      routes.push(...this.getAllRoutes(child, newPrefix));\n    }\n\n    return routes;\n  }\n\n  private createRequest(): Request {\n    return {\n      params: this.params,\n      query: this.query,\n      url: this.url,\n      path: this.path,\n      matches: this.matches,\n      redirect: (path: string) => this.go(path)\n    };\n  }\n\n  private getErrorConditionMiddlewares(error: any): Middlewares | false {\n    // Search first for class and name errors\n    for (const [condition, middlewares] of this.errorHandlers) {\n      if (\n        typeof condition !== \"number\" &&\n        typeof condition !== \"string\" &&\n        error instanceof (condition as any) &&\n        error.name === condition.name\n      ) {\n        return middlewares;\n      }\n    }\n\n    // then for code errors\n    for (const [condition, middlewares] of this.errorHandlers) {\n      if (typeof condition === \"number\" && (error.status === condition || error.code === condition)) {\n        return middlewares;\n      }\n    }\n\n    // and then for message errors\n    for (const [condition, middlewares] of this.errorHandlers) {\n      if (typeof condition === \"string\" && (error.name === condition || error.message.includes(condition))) {\n        return middlewares;\n      }\n    }\n\n    // If no specific error handler is found, return the generic one\n    return this.errorHandlers.get(\"generic\") || false;\n  }\n\n  // eslint-disable-next-line sonarjs/cognitive-complexity\n  private async handleError(\n    error: Error,\n    parentComponent?: Component | POJOComponent | VnodeComponentInterface\n  ): Promise<void | string> {\n    const request: Request = this.createRequest();\n    let component = null;\n    const middlewares = this.getErrorConditionMiddlewares(error);\n\n    // If no error handler is found, throw the error\n    if (middlewares === false) {\n      throw error;\n    }\n\n    let response;\n    try {\n      for (const middleware of middlewares) {\n        response = await middleware(request, error);\n\n        // If the response is a component or vnode, return it for rendering\n        if (response !== undefined && (isComponent(response) || isVnodeComponent(response))) {\n          component = response;\n          break;\n        }\n\n        // If the response is false, stop the middleware chain\n        if (response === false) {\n          return;\n        }\n      }\n    } catch (err) {\n      // If an error occurs during the error handling, we handle it recursively\n      (err as Error).cause = error;\n\n      let errorCauseCount = 0;\n      while ((err as Error).cause) {\n        errorCauseCount++;\n      }\n\n      if (errorCauseCount > 20) {\n        throw new RouterError(\"Too many error causes. Possible circular error handling.\");\n      }\n\n      return this.handleError(err as Error, parentComponent);\n    }\n\n    if (component) {\n      // If there is an error middleware that returns a component, we return it\n      if (isComponent(parentComponent) || isVnodeComponent(parentComponent)) {\n        const childComponent = isVnodeComponent(component) ? component : v(component as Component, {});\n        if (isVnodeComponent(parentComponent)) {\n          parentComponent.children.push(childComponent);\n          component = parentComponent;\n        } else {\n          component = v(parentComponent, {}, childComponent) as VnodeComponentInterface;\n        }\n      }\n\n      // If we are in the browser, we update the URL\n      if (!isNodeJs && window.location.pathname + window.location.search !== this.url) {\n        window.history.pushState(null, \"\", this.url);\n      }\n\n      // If there is a container, we mount the component\n      if (this.container) {\n        return mount(this.container, component);\n      }\n    }\n\n    // If there is no component to render, we throw the error\n    throw error;\n  }\n\n  private async searchComponent(\n    middlewares: Middlewares,\n    parentComponent?: Component | POJOComponent | VnodeComponentInterface\n  ) {\n    const request: Request = this.createRequest();\n\n    let response;\n\n    for (const middleware of middlewares) {\n      try {\n        response = await middleware(request);\n      } catch (error) {\n        return this.handleError(error as Error, parentComponent);\n      }\n\n      // If the response is a component or vnode, return it for rendering\n      if (response !== undefined && (isComponent(response) || isVnodeComponent(response))) {\n        return response;\n      }\n\n      // If the response is false, stop the middleware chain\n      if (response === false) {\n        return false;\n      }\n    }\n\n    return response;\n  }\n}\n\nlet localRedirect: RedirectFunction;\n\nexport async function redirect(\n  url: string,\n  parentComponent?: Component | POJOComponent | VnodeComponentInterface,\n  preventPushState = false\n): Promise<string | void> {\n  if (!localRedirect) {\n    // eslint-disable-next-line no-console\n    console.warn(\"Redirect function is not initialized. Please mount the router first.\");\n    return;\n  }\n  return localRedirect(url, parentComponent, preventPushState);\n}\n\nexport function mountRouter(elementContainer: string | any, router: Router): void {\n  router.container = elementContainer;\n  localRedirect = router.go.bind(router);\n\n  if (!isNodeJs) {\n    function onPopStateGoToRoute(): void {\n      const pathWithoutPrefix = getPathWithoutPrefix(document.location.pathname, router.pathPrefix);\n      (router as unknown as Router).go(pathWithoutPrefix);\n    }\n    window.addEventListener(\"popstate\", onPopStateGoToRoute, false);\n    onPopStateGoToRoute();\n  }\n\n  directive(\"route\", (url: string, vnode: VnodeWithDom): void => {\n    setAttribute(\"href\", url, vnode);\n    setAttribute(\"onclick\", router.getOnClickHandler(url), vnode);\n  });\n}\n"],
  "mappings": ";AAEA;AAAA,EAKE;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,OACK;AAiCP,SAAS,KAAK,OAAY;AACxB,SAAO,MAAM,QAAQ,KAAK,IAAI,MAAM,KAAK,QAAQ,IAAI,CAAC,KAAK;AAC7D;AAEA,SAAS,qBAAqB,MAAc,QAAgB;AAC1D,SAAO,wBAAwB,KAAK,QAAQ,IAAI,OAAO,IAAI,MAAM,EAAE,GAAG,EAAE,CAAC;AAC3E;AAEA,SAAS,wBAAwB,MAAc;AAC7C,MAAI,uBAAuB,KAAK,QAAQ,OAAO,EAAE;AACjD,MAAI,yBAAyB,IAAI;AAC/B,2BAAuB;AAAA,EACzB;AACA,SAAO;AACT;AAGA,SAAS,WAAW,YAA0C;AAC5D,QAAM,QAAQ,aAAa,WAAW,MAAM,GAAG,IAAI,CAAC;AACpD,QAAM,QAA6B,CAAC;AAEpC,aAAW,aAAa,OAAO;AAC7B,UAAM,CAAC,MAAM,KAAK,IAAI,UAAU,MAAM,KAAK,CAAC;AAC5C,UAAM,IAAI,IACR,MAAM,OAAO,KAAK,CAAC,MAAM,QAAQ,OAAO,KAAK,IAAI,UAAU,SAAS,OAAO,UAAU,UAAU,QAAQ;AAAA,EAC3G;AAEA,SAAO;AACT;AAUA,IAAM,YAAN,MAAgB;AAAA,EACd,OAAkB,EAAE,SAAS,IAAI,UAAU,oBAAI,IAAI,GAAG,WAAW,MAAM;AAAA,EAEvE,SAAS,MAAc,aAA0B;AAC/C,UAAM,WAAW,SAAS,MAAM,CAAC,IAAI,IAAI,KAAK,MAAM,GAAG,EAAE,OAAO,OAAO;AACvE,QAAI,cAAc,KAAK;AAEvB,eAAW,WAAW,UAAU;AAC9B,YAAM,YAAY,QAAQ,WAAW,GAAG;AACxC,YAAM,MAAM,YAAY,MAAM;AAE9B,UAAI,CAAC,YAAY,SAAS,IAAI,GAAG,GAAG;AAClC,oBAAY,SAAS,IAAI,KAAK;AAAA,UAC5B;AAAA,UACA,UAAU,oBAAI,IAAI;AAAA,UAClB;AAAA,UACA,UAAU,YAAY,QAAQ,MAAM,CAAC,IAAI;AAAA,QAC3C,CAAC;AAAA,MACH;AAEA,oBAAc,YAAY,SAAS,IAAI,GAAG;AAAA,IAC5C;AAEA,gBAAY,cAAc;AAAA,EAC5B;AAAA;AAAA;AAAA,EAIA,UAAU,MAAoF;AAC5F,UAAM,uBAAuB,wBAAwB,IAAI;AACzD,UAAM,WACJ,yBAAyB,MAAM,CAAC,oBAAoB,IAAI,qBAAqB,MAAM,GAAG,EAAE,OAAO,OAAO;AACxG,QAAI,cAAgC,KAAK;AACzC,UAAM,SAAiC,CAAC;AAExC,UAAM,sBAAmC,CAAC;AAC1C,UAAM,iBAAiB,SAAS;AAEhC,aAAS,IAAI,GAAG,IAAI,gBAAgB,KAAK;AACvC,UAAI,CAAC,aAAa;AAChB;AAAA,MACF;AAEA,YAAM,UAAU,SAAS,CAAC;AAE1B,UAAI,QAAQ;AAEZ,iBAAW,CAAC,KAAK,KAAK,KAAK,YAAY,UAAU;AAC/C,YAAI,QAAQ,SAAS;AACnB,wBAAc;AACd,kBAAQ;AACR;AAAA,QACF;AAEA,YAAI,YAAY,QAAQ,QAAQ,KAAK;AACnC,wBAAc;AACd,iBAAO,MAAM,QAAS,IAAI;AAC1B,kBAAQ;AACR;AAAA,QACF;AAEA,YAAI,QAAQ,QAAQ,CAAC,OAAO;AAC1B,8BAAoB,KAAK,GAAI,MAAM,eAAe,CAAC,CAAE;AAAA,QACvD;AAAA,MACF;AAEA,UAAI,CAAC,OAAO;AACV,YAAI,YAAY,SAAS,IAAI,IAAI,GAAG;AAClC,iBAAO,EAAE,aAAa,qBAAqB,OAAO;AAAA,QACpD;AACA,eAAO;AAAA,MACT;AAAA,IACF;AAGA,UAAM,iBAAiB,CAAC,GAAG,qBAAqB,GAAI,YAAY,eAAe,CAAC,CAAE;AAGlF,QAAI,eAAe,WAAW,GAAG;AAC/B,aAAO;AAAA,IACT;AAGA,WAAO,EAAE,aAAa,gBAAgB,OAAO;AAAA,EAC/C;AACF;AAEO,IAAM,cAAc,MAAMA,qBAAoB,MAAM;AAAA,EACzD,SAA6B;AAC/B;AAEO,IAAM,SAAN,MAAM,QAAO;AAAA,EACV,YAAY,IAAI,UAAU;AAAA,EAClC,YAAqC;AAAA,EACrC,QAAyC,CAAC;AAAA,EAC1C,UAA+B,CAAC;AAAA,EAChC,MAAc;AAAA,EACd,OAAe;AAAA,EACf,SAAgD,CAAC;AAAA,EACjD,UAAoB,CAAC;AAAA,EACrB,aAAqB;AAAA,EAEb,gBAAuE,oBAAI,IAAI;AAAA,EAEvF,YAAY,aAAqB,IAAI;AACnC,SAAK,aAAa;AAAA,EACpB;AAAA,EAEA,OAAO,MAAgD;AACrD,UAAM,WAAW,KAAK,IAAI;AAC1B,UAAM,OAAO;AAAA,MACX,GAAG,KAAK,UAAU,GAAG,OAAO,SAAS,CAAC,MAAM,WAAW,SAAS,MAAM,IAAI,KAAK;AAAA,IACjF;AAGA,QAAI,SAAS,WAAW,KAAK,SAAS,CAAC,aAAa,SAAQ;AAC1D,YAAM,YAAY,SAAS,CAAC;AAC5B,iBAAW,YAAY,UAAU,OAAO,GAAG;AACzC,cAAM,eAAe,GAAG,IAAI,GAAG,QAAQ;AACvC,aAAK,UAAU,SAAS,cAAc,UAAU,UAAU,UAAU,QAAQ,EAAG,eAAe,CAAC,CAAC;AAAA,MAClG;AAAA,IACF,OAAO;AAEL,UAAI,SAAS,KAAK,CAAC,SAAS,gBAAgB,OAAM,GAAG;AACnD,cAAM,IAAI,YAAY,qDAAqD;AAAA,MAC7E;AAGA,UAAI,SAAS,KAAK,CAAC,SAAS,OAAO,SAAS,UAAU,GAAG;AACvD,cAAM,IAAI,YAAY,oCAAoC;AAAA,MAC5D;AAEA,WAAK,UAAU,SAAS,MAAM,QAAuB;AAAA,IACvD;AAEA,WAAO;AAAA,EACT;AAAA,EAEA,SAAS,MAAwD;AAC/D,UAAM,YACJ,OAAO,KAAK,CAAC,MAAM,YAAY,OAAO,KAAK,CAAC,MAAM,YAAY,KAAK,CAAC,EAAE,KAAK,SAAS,OAAO,IACtF,KAAK,MAAM,IACZ;AAEN,QAAI,OAAO,cAAc,YAAY,OAAO,cAAc,YAAY,CAAC,UAAU,KAAK,SAAS,OAAO,GAAG;AACvG,YAAM,IAAI,YAAY,iEAAiE;AAAA,IACzF;AAGA,QAAI,KAAK,KAAK,CAAC,SAAS,OAAO,SAAS,UAAU,GAAG;AACnD,YAAM,IAAI,YAAY,oCAAoC;AAAA,IAC5D;AAEA,QAAI,WAAW,KAAK,cAAc,IAAI,SAAS;AAC/C,QAAI,CAAC,UAAU;AACb,iBAAW,CAAC;AACZ,WAAK,cAAc,IAAI,WAAW,QAAQ;AAAA,IAC5C;AAEA,aAAS,KAAK,GAAI,IAAoB;AACtC,WAAO;AAAA,EACT;AAAA,EAEA,SAAmB;AACjB,WAAO,KAAK,aAAa,KAAK,UAAU,MAAM,EAAE;AAAA,EAClD;AAAA,EAEA,MAAM,GACJ,MACA,iBACwB;AACxB,QAAI,CAAC,MAAM;AACT,aAAO,KAAK,YAAY,IAAI,YAAY,mBAAmB,GAAG,eAAe;AAAA,IAC/E;AAEA,QAAI,mBAAmB,KAAK,IAAI,GAAG;AACjC,aAAO,KAAK,YAAY,IAAI,YAAY,WAAW,IAAI,gBAAgB,CAAC;AAAA,IAC1E;AAEA,UAAM,kBAAkB,wBAAwB,GAAG,KAAK,UAAU,GAAG,IAAI,EAAE;AAC3E,UAAM,QAAQ,gBAAgB,MAAM,KAAK,CAAC;AAC1C,SAAK,MAAM;AACX,SAAK,QAAQ,WAAW,MAAM,CAAC,CAAC;AAEhC,UAAM,YAAY,MAAM,CAAC,EAAE,QAAQ,WAAW,IAAI,EAAE,MAAM,GAAG,EAAE,CAAC;AAChE,SAAK,OAAO;AAEZ,QAAI,QAAQ,KAAK,UAAU,UAAU,SAAS;AAE9C,QAAI,CAAC,SAAS,CAAC,MAAM,aAAa;AAEhC,YAAM,iBAAiB,UAAU,MAAM,GAAG;AAE1C,aAAO,eAAe,SAAS,GAAG;AAChC,uBAAe,IAAI;AACnB,cAAM,gBAAgB,KAAK,UAAU,UAAU,eAAe,KAAK,GAAG,IAAI,KAAK;AAC/E,YAAI,eAAe;AACjB,kBAAQ;AACR;AAAA,QACF;AAAA,MACF;AAGA,UAAI,CAAC,SAAS,CAAC,MAAM,aAAa;AAChC,cAAM,QAAQ,IAAI,YAAY,WAAW,eAAe,kDAAkD;AAC1G,QAAC,MAAc,SAAS;AACxB,eAAO,KAAK,YAAY,OAAO,eAAe;AAAA,MAChD;AAAA,IACF;AAEA,UAAM,EAAE,aAAa,OAAO,IAAI;AAChC,SAAK,SAAS;AAEd,QAAI,YAAY,MAAM,KAAK,gBAAgB,aAAa,eAAe;AAEvE,QAAI,cAAc,OAAO;AACvB;AAAA,IACF;AAEA,QAAI,CAAC,WAAW;AACd,aAAO,KAAK;AAAA,QACV,IAAI,YAAY,WAAW,eAAe,oCAAoC;AAAA,QAC9E;AAAA,MACF;AAAA,IACF;AAEA,QAAI,YAAY,eAAe,KAAK,iBAAiB,eAAe,GAAG;AACrE,YAAM,iBAAiB,iBAAiB,SAAS,IAAI,YAAY,EAAE,WAAwB,CAAC,CAAC;AAC7F,UAAI,iBAAiB,eAAe,GAAG;AACrC,wBAAgB,SAAS,KAAK,cAAc;AAC5C,oBAAY;AAAA,MACd,OAAO;AACL,oBAAY,EAAE,iBAAiB,CAAC,GAAG,cAAc;AAAA,MACnD;AAAA,IACF;AAEA,QAAI,CAAC,YAAY,OAAO,SAAS,WAAW,OAAO,SAAS,WAAW,iBAAiB;AACtF,aAAO,QAAQ,UAAU,MAAM,IAAI,eAAe;AAAA,IACpD;AAEA,QAAI,KAAK,WAAW;AAClB,aAAO,MAAM,KAAK,WAAW,SAAS;AAAA,IACxC;AAAA,EACF;AAAA,EAEA,kBAAkB,KAAa;AAC7B,WAAO,CAAC,MAAkB;AACxB,UAAI,EAAE,WAAW,KAAK,EAAE,WAAW,EAAE,WAAW,EAAE,YAAY,EAAE,UAAU,EAAE,kBAAkB;AAC5F;AAAA,MACF;AAEA,UAAI,OAAO,QAAQ,YAAY,IAAI,SAAS,GAAG;AAC7C,aAAK,GAAG,GAAG;AAAA,MACb;AACA,QAAE,eAAe;AAAA,IACnB;AAAA,EACF;AAAA,EAEQ,aAAa,MAAiB,QAA0B;AAC9D,UAAM,SAAmB,CAAC;AAE1B,eAAW,CAAC,KAAK,KAAK,KAAK,KAAK,UAAU;AAExC,YAAM,YAAY,GAAG,MAAM,IAAI,MAAM,YAAY,IAAI,MAAM,QAAQ,KAAK,GAAG,GAAG,QAAQ,OAAO,EAAE;AAC/F,UAAI,MAAM,aAAa;AACrB,eAAO,KAAK,SAAS;AAAA,MACvB;AACA,aAAO,KAAK,GAAG,KAAK,aAAa,OAAO,SAAS,CAAC;AAAA,IACpD;AAEA,WAAO;AAAA,EACT;AAAA,EAEQ,gBAAyB;AAC/B,WAAO;AAAA,MACL,QAAQ,KAAK;AAAA,MACb,OAAO,KAAK;AAAA,MACZ,KAAK,KAAK;AAAA,MACV,MAAM,KAAK;AAAA,MACX,SAAS,KAAK;AAAA,MACd,UAAU,CAAC,SAAiB,KAAK,GAAG,IAAI;AAAA,IAC1C;AAAA,EACF;AAAA,EAEQ,6BAA6B,OAAiC;AAEpE,eAAW,CAAC,WAAW,WAAW,KAAK,KAAK,eAAe;AACzD,UACE,OAAO,cAAc,YACrB,OAAO,cAAc,YACrB,iBAAkB,aAClB,MAAM,SAAS,UAAU,MACzB;AACA,eAAO;AAAA,MACT;AAAA,IACF;AAGA,eAAW,CAAC,WAAW,WAAW,KAAK,KAAK,eAAe;AACzD,UAAI,OAAO,cAAc,aAAa,MAAM,WAAW,aAAa,MAAM,SAAS,YAAY;AAC7F,eAAO;AAAA,MACT;AAAA,IACF;AAGA,eAAW,CAAC,WAAW,WAAW,KAAK,KAAK,eAAe;AACzD,UAAI,OAAO,cAAc,aAAa,MAAM,SAAS,aAAa,MAAM,QAAQ,SAAS,SAAS,IAAI;AACpG,eAAO;AAAA,MACT;AAAA,IACF;AAGA,WAAO,KAAK,cAAc,IAAI,SAAS,KAAK;AAAA,EAC9C;AAAA;AAAA,EAGA,MAAc,YACZ,OACA,iBACwB;AACxB,UAAM,UAAmB,KAAK,cAAc;AAC5C,QAAI,YAAY;AAChB,UAAM,cAAc,KAAK,6BAA6B,KAAK;AAG3D,QAAI,gBAAgB,OAAO;AACzB,YAAM;AAAA,IACR;AAEA,QAAI;AACJ,QAAI;AACF,iBAAW,cAAc,aAAa;AACpC,mBAAW,MAAM,WAAW,SAAS,KAAK;AAG1C,YAAI,aAAa,WAAc,YAAY,QAAQ,KAAK,iBAAiB,QAAQ,IAAI;AACnF,sBAAY;AACZ;AAAA,QACF;AAGA,YAAI,aAAa,OAAO;AACtB;AAAA,QACF;AAAA,MACF;AAAA,IACF,SAAS,KAAK;AAEZ,MAAC,IAAc,QAAQ;AAEvB,UAAI,kBAAkB;AACtB,aAAQ,IAAc,OAAO;AAC3B;AAAA,MACF;AAEA,UAAI,kBAAkB,IAAI;AACxB,cAAM,IAAI,YAAY,0DAA0D;AAAA,MAClF;AAEA,aAAO,KAAK,YAAY,KAAc,eAAe;AAAA,IACvD;AAEA,QAAI,WAAW;AAEb,UAAI,YAAY,eAAe,KAAK,iBAAiB,eAAe,GAAG;AACrE,cAAM,iBAAiB,iBAAiB,SAAS,IAAI,YAAY,EAAE,WAAwB,CAAC,CAAC;AAC7F,YAAI,iBAAiB,eAAe,GAAG;AACrC,0BAAgB,SAAS,KAAK,cAAc;AAC5C,sBAAY;AAAA,QACd,OAAO;AACL,sBAAY,EAAE,iBAAiB,CAAC,GAAG,cAAc;AAAA,QACnD;AAAA,MACF;AAGA,UAAI,CAAC,YAAY,OAAO,SAAS,WAAW,OAAO,SAAS,WAAW,KAAK,KAAK;AAC/E,eAAO,QAAQ,UAAU,MAAM,IAAI,KAAK,GAAG;AAAA,MAC7C;AAGA,UAAI,KAAK,WAAW;AAClB,eAAO,MAAM,KAAK,WAAW,SAAS;AAAA,MACxC;AAAA,IACF;AAGA,UAAM;AAAA,EACR;AAAA,EAEA,MAAc,gBACZ,aACA,iBACA;AACA,UAAM,UAAmB,KAAK,cAAc;AAE5C,QAAI;AAEJ,eAAW,cAAc,aAAa;AACpC,UAAI;AACF,mBAAW,MAAM,WAAW,OAAO;AAAA,MACrC,SAAS,OAAO;AACd,eAAO,KAAK,YAAY,OAAgB,eAAe;AAAA,MACzD;AAGA,UAAI,aAAa,WAAc,YAAY,QAAQ,KAAK,iBAAiB,QAAQ,IAAI;AACnF,eAAO;AAAA,MACT;AAGA,UAAI,aAAa,OAAO;AACtB,eAAO;AAAA,MACT;AAAA,IACF;AAEA,WAAO;AAAA,EACT;AACF;AAEA,IAAI;AAEJ,eAAsB,SACpB,KACA,iBACA,mBAAmB,OACK;AACxB,MAAI,CAAC,eAAe;AAElB,YAAQ,KAAK,sEAAsE;AACnF;AAAA,EACF;AACA,SAAO,cAAc,KAAK,iBAAiB,gBAAgB;AAC7D;AAEO,SAAS,YAAY,kBAAgC,QAAsB;AAChF,SAAO,YAAY;AACnB,kBAAgB,OAAO,GAAG,KAAK,MAAM;AAErC,MAAI,CAAC,UAAU;AACb,QAASC,uBAAT,WAAqC;AACnC,YAAM,oBAAoB,qBAAqB,SAAS,SAAS,UAAU,OAAO,UAAU;AAC5F,MAAC,OAA6B,GAAG,iBAAiB;AAAA,IACpD;AAHS,8BAAAA;AAIT,WAAO,iBAAiB,YAAYA,sBAAqB,KAAK;AAC9D,IAAAA,qBAAoB;AAAA,EACtB;AAEA,YAAU,SAAS,CAAC,KAAa,UAA8B;AAC7D,iBAAa,QAAQ,KAAK,KAAK;AAC/B,iBAAa,WAAW,OAAO,kBAAkB,GAAG,GAAG,KAAK;AAAA,EAC9D,CAAC;AACH;",
  "names": ["RouterError", "onPopStateGoToRoute"]
}
