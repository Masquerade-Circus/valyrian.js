(()=>{"use strict";var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,a={};((e,i)=>{for(var s in i)t(e,s,{get:i[s],enumerable:!0})})(a,{SwRuntimeManager:()=>g,registerSw:()=>u});var r,n=(r=a,((a,r,n,o)=>{if(r&&"object"==typeof r||"function"==typeof r)for(let l of i(r))s.call(a,l)||l===n||t(a,l,{get:()=>r[l],enumerable:!(o=e(r,l))||o.enumerable});return a})(t({},"__esModule",{value:!0}),r)),o=require("valyrian.js"),l=require("valyrian.js/utils");function h(t){return Boolean(t&&"serviceWorker"in t)}async function u(t="./sw.js",e={scope:"/"},i=globalThis.navigator||null){if(h(i))return i.serviceWorker.register(t,e)}var g=class{#t;#e;#i;#s;#a;#r;#n={updateAvailable:!1,installing:!1,registration:null,waiting:null};#o={registered:new Set,updateavailable:new Set,updated:new Set,error:new Set};#l=!1;#h=()=>{this.#n.updateAvailable=!1,this.#n.waiting=null,this.#u("updated"),"manual"!==this.#i&&(0,l.isFunction)(this.#r?.location?.reload)&&this.#r.location.reload()};constructor(t={}){const e=t.runtime||{};this.#t=t.swUrl||"./sw.js",this.#e=t.scope||"/",this.#i=t.strategy||"prompt-user",this.#s=e.isNodeJs??o.isNodeJs,this.#a=e.navigator??globalThis.navigator??null,this.#r=e.window??globalThis.window??null}get state(){return t=this.#n,Object.freeze({...t});var t}on(t,e){return this.#o[t].add(e),()=>this.off(t,e)}off(t,e){this.#o[t].delete(e)}#u(t,e){for(const i of this.#o[t])i(e)}#g(){return!this.#s&&h(this.#a)}async init(){if(this.#l||!this.#g())return this;this.#l=!0;try{const t=await u(this.#t,{scope:this.#e},this.#a);if(!t)return this;this.#n.registration=t,this.#n.waiting=t.waiting||null,this.#n.updateAvailable=Boolean(t.waiting),this.#u("registered",t),"auto"===this.#i&&this.#n.waiting&&this.applyUpdate(),t.addEventListener("updatefound",()=>{this.#n.installing=!0;const e=t.installing;e&&e.addEventListener("statechange",()=>{if("installed"!==e.state)return;this.#n.installing=!1;const i=this.#a?.serviceWorker;i?.controller&&(this.#n.waiting=t.waiting||e,this.#n.updateAvailable=!0,this.#u("updateavailable",{waiting:this.#n.waiting}),"auto"===this.#i&&this.applyUpdate())})}),this.#a.serviceWorker.addEventListener("controllerchange",this.#h)}catch(t){this.#u("error",t)}return this}applyUpdate(){this.#n.waiting&&this.#n.waiting.postMessage({type:"SKIP_WAITING"})}async checkForUpdate(){this.#n.registration&&await this.#n.registration.update()}async unregister(){if(!this.#n.registration)return!1;if(this.#g()){const t=this.#a.serviceWorker;(0,l.isFunction)(t.removeEventListener)&&t.removeEventListener("controllerchange",this.#h)}return this.#n.registration.unregister()}};"undefined"!=typeof module?module.exports=n:self.ValyrianSw=n})();//# sourceMappingURL=index.min.js.map