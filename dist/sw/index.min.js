(()=>{"use strict";var t=Object.defineProperty,e=Object.getOwnPropertyDescriptor,i=Object.getOwnPropertyNames,s=Object.prototype.hasOwnProperty,r={};((e,i)=>{for(var s in i)t(e,s,{get:i[s],enumerable:!0})})(r,{SwRuntimeManager:()=>g,registerSw:()=>u});var a,n=(a=r,((r,a,n,o)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let l of i(a))s.call(r,l)||l===n||t(r,l,{get:()=>a[l],enumerable:!(o=e(a,l))||o.enumerable});return r})(t({},"__esModule",{value:!0}),a)),o=require("valyrian.js"),l=require("valyrian.js/utils");function h(t){return Boolean(t&&"serviceWorker"in t)}async function u(t="./sw.js",e={scope:"/"},i=globalThis.navigator||null){if(h(i))return i.serviceWorker.register(t,e)}var g=class{#t;#e;#i;#s;#r;#a;#n={updateAvailable:!1,installing:!1,registration:null,waiting:null};#o={registered:new Set,updateavailable:new Set,updated:new Set,error:new Set};#l=()=>{this.#n.updateAvailable=!1,this.#n.waiting=null,this.#h("updated"),"manual"!==this.#i&&(0,l.isFunction)(this.#a?.location?.reload)&&this.#a.location.reload()};constructor(t={}){const e=t.runtime||{};this.#t=t.swUrl||"./sw.js",this.#e=t.scope||"/",this.#i=t.strategy||"prompt-user",this.#s=e.isNodeJs??o.isNodeJs,this.#r=e.navigator??globalThis.navigator??null,this.#a=e.window??globalThis.window??null}get state(){return t=this.#n,Object.freeze({...t});var t}on(t,e){return this.#o[t].add(e),()=>this.off(t,e)}off(t,e){this.#o[t].delete(e)}#h(t,e){for(const i of this.#o[t])i(e)}#u(){return!this.#s&&h(this.#r)}async init(){if(!this.#u())return this;try{const t=await u(this.#t,{scope:this.#e},this.#r);if(!t)return this;this.#n.registration=t,this.#n.waiting=t.waiting||null,this.#n.updateAvailable=Boolean(t.waiting),this.#h("registered",t),"auto"===this.#i&&this.#n.waiting&&this.applyUpdate(),t.addEventListener("updatefound",()=>{this.#n.installing=!0;const e=t.installing;e&&e.addEventListener("statechange",()=>{if("installed"!==e.state)return;this.#n.installing=!1;const i=this.#r?.serviceWorker;i?.controller&&(this.#n.waiting=t.waiting||e,this.#n.updateAvailable=!0,this.#h("updateavailable",{waiting:this.#n.waiting}),"auto"===this.#i&&this.applyUpdate())})}),this.#r.serviceWorker.addEventListener("controllerchange",this.#l)}catch(t){this.#h("error",t)}return this}applyUpdate(){this.#n.waiting&&this.#n.waiting.postMessage({type:"SKIP_WAITING"})}async checkForUpdate(){this.#n.registration&&await this.#n.registration.update()}async unregister(){if(!this.#n.registration)return!1;if(this.#u()){const t=this.#r.serviceWorker;(0,l.isFunction)(t.removeEventListener)&&t.removeEventListener("controllerchange",this.#l)}return this.#n.registration.unregister()}};"undefined"!=typeof module?module.exports=n:self.ValyrianSw=n})();//# sourceMappingURL=index.min.js.map