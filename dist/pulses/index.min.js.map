//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJpbmRleF9leHBvcnRzIiwiX19leHBvcnQiLCJjcmVhdGVFZmZlY3QiLCJjcmVhdGVNdXRhYmxlU3RvcmUiLCJjcmVhdGVQdWxzZSIsImNyZWF0ZVB1bHNlU3RvcmUiLCJfX0VYUE9SVFNfXyIsImltcG9ydF92YWx5cmlhbiIsInJlcXVpcmUiLCJpbXBvcnRfdXRpbHMiLCJlZmZlY3RTdGFjayIsInJlZ2lzdGVyRG9tU3Vic2NyaXB0aW9uIiwic3Vic2NyaWJlcnMiLCJkb21XaXRoVm5vZGVzVG9VcGRhdGUiLCJjdXJyZW50Vm5vZGUiLCJjdXJyZW50Iiwidm5vZGUiLCJoYXMiLCJkb20iLCJoYXNQYXJlbnQiLCJwYXJlbnQiLCJwYXJlbnRFbGVtZW50Iiwic3Vic2NyaXB0aW9uIiwidXBkYXRlVm5vZGUiLCJkZWxldGUiLCJhZGQiLCJjcmVhdGVTdG9yZSIsImluaXRpYWxTdGF0ZSIsInB1bHNlcyIsImltbXV0YWJsZSIsIlNldCIsIldlYWtTZXQiLCJib3VuZFB1bHNlcyIsImtleSIsIkVycm9yIiwiZ2V0UHVsc2VNZXRob2QiLCJsb2NhbFN0YXRlIiwiaXNNdXRhYmxlIiwiY3VycmVudFN0YXRlIiwicHVsc2VDYWxsQ291bnQiLCJwcm94eVN0YXRlIiwiUHJveHkiLCJnZXQiLCJzdGF0ZSIsInByb3AiLCJjdXJyZW50RWZmZWN0IiwibGVuZ3RoIiwic2V0IiwidmFsdWUiLCJSZWZsZWN0IiwiZGVsZXRlUHJvcGVydHkiLCJzeW5jU3RhdGUiLCJuZXdTdGF0ZSIsImRlZXBGcmVlemUiLCJkZWJvdW5jZVRpbWVvdXQiLCJzZXRTdGF0ZSIsImZsdXNoIiwiaGFzQ2hhbmdlZCIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJmb3JFYWNoIiwic3Vic2NyaWJlciIsImFyZ3MiLCJkZWVwQ2xvbmVVbmZyZWV6ZSIsImNvbnRleHQiLCJPYmplY3QiLCJjcmVhdGUiLCIkZmx1c2giLCJlbXB0eUZsdXNoIiwiaGFuZGxlRXJyb3IiLCJlcnJvciIsImNvbnNvbGUiLCJldmVudCIsInByZXZlbnREZWZhdWx0Iiwic3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uIiwicHVsc2VSZXN1bHQiLCJhcHBseSIsIlByb21pc2UiLCJ0aGVuIiwicmVzb2x2ZWRWYWx1ZSIsImNhdGNoIiwibGlzdGVuZXJzIiwidHJpZ2dlciIsImNhbGxiYWNrIiwicHVzaCIsImZpbHRlciIsImNiIiwicHVsc2VNZXRob2QiLCJyZXN1bHQiLCJyIiwid2FybiIsImVmZmVjdCIsInJ1bkVmZmVjdCIsInBvcCIsImdsb2JhbFRoaXMiLCJpbml0aWFsVmFsdWUiLCJydW5TdWJzY3JpYmVycyIsIm5ld1ZhbHVlIl0sInNvdXJjZXMiOlsiLi4vLi4vbGliL3B1bHNlcy9pbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLWZ1bmN0aW9uLXR5cGUgKi9cblxuaW1wb3J0IHsgdXBkYXRlVm5vZGUsIFZub2RlV2l0aERvbSwgY3VycmVudCwgRG9tRWxlbWVudCB9IGZyb20gXCJ2YWx5cmlhbi5qc1wiO1xuaW1wb3J0IHsgZGVlcENsb25lVW5mcmVlemUsIGRlZXBGcmVlemUsIGhhc0NoYW5nZWQgfSBmcm9tIFwidmFseXJpYW4uanMvdXRpbHNcIjtcblxudHlwZSBTdGF0ZSA9IFJlY29yZDxzdHJpbmcsIGFueT47XG5cbmV4cG9ydCB0eXBlIFB1bHNlQ29udGV4dCA9IHtcbiAgJGZsdXNoOiAoKSA9PiB2b2lkO1xufTtcblxuZXhwb3J0IHR5cGUgUHVsc2U8U3RhdGVUeXBlLCBUUmV0dXJuID0gdW5rbm93bj4gPSAoc3RhdGU6IFN0YXRlVHlwZSwgLi4uYXJnczogYW55W10pID0+IFRSZXR1cm4gfCBQcm9taXNlPFRSZXR1cm4+O1xuXG50eXBlIFByb3h5U3RhdGU8U3RhdGVUeXBlPiA9IFN0YXRlVHlwZSAmIHsgW2tleTogc3RyaW5nXTogYW55IH07XG5cbmNvbnN0IGVmZmVjdFN0YWNrOiBGdW5jdGlvbltdID0gW107XG5cbnR5cGUgU3RvcmVQdWxzZXM8UHVsc2VzVHlwZT4gPSB7XG4gIFtLIGluIGtleW9mIFB1bHNlc1R5cGVdOiBQdWxzZXNUeXBlW0tdIGV4dGVuZHMgKHN0YXRlOiBhbnksIC4uLmFyZ3M6IGluZmVyIEFyZ3MpID0+IGluZmVyIFJcbiAgICA/ICguLi5hcmdzOiBBcmdzKSA9PiBSXG4gICAgOiBuZXZlcjtcbn07XG5cbmZ1bmN0aW9uIHJlZ2lzdGVyRG9tU3Vic2NyaXB0aW9uKHN1YnNjcmliZXJzOiBTZXQ8RnVuY3Rpb24+LCBkb21XaXRoVm5vZGVzVG9VcGRhdGU6IFdlYWtTZXQ8RG9tRWxlbWVudD4pOiB2b2lkIHtcbiAgY29uc3QgY3VycmVudFZub2RlID0gY3VycmVudC52bm9kZSBhcyBWbm9kZVdpdGhEb207XG4gIGlmICghY3VycmVudFZub2RlIHx8IGRvbVdpdGhWbm9kZXNUb1VwZGF0ZS5oYXMoY3VycmVudFZub2RlLmRvbSkpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBsZXQgaGFzUGFyZW50ID0gZmFsc2U7XG4gIGxldCBwYXJlbnQgPSBjdXJyZW50Vm5vZGUuZG9tLnBhcmVudEVsZW1lbnQgYXMgRG9tRWxlbWVudDtcbiAgd2hpbGUgKHBhcmVudCkge1xuICAgIGlmIChkb21XaXRoVm5vZGVzVG9VcGRhdGUuaGFzKHBhcmVudCkpIHtcbiAgICAgIGhhc1BhcmVudCA9IHRydWU7XG4gICAgICBicmVhaztcbiAgICB9XG4gICAgcGFyZW50ID0gcGFyZW50LnBhcmVudEVsZW1lbnQgYXMgRG9tRWxlbWVudDtcbiAgfVxuXG4gIGlmICghaGFzUGFyZW50KSB7XG4gICAgY29uc3QgZG9tID0gY3VycmVudFZub2RlLmRvbTtcbiAgICBjb25zdCBzdWJzY3JpcHRpb24gPSAoKSA9PiB7XG4gICAgICB1cGRhdGVWbm9kZShkb20udm5vZGUpO1xuICAgICAgaWYgKCFkb20ucGFyZW50RWxlbWVudCkge1xuICAgICAgICBzdWJzY3JpYmVycy5kZWxldGUoc3Vic2NyaXB0aW9uKTtcbiAgICAgICAgZG9tV2l0aFZub2Rlc1RvVXBkYXRlLmRlbGV0ZShkb20pO1xuICAgICAgfVxuICAgIH07XG4gICAgc3Vic2NyaWJlcnMuYWRkKHN1YnNjcmlwdGlvbik7XG4gICAgZG9tV2l0aFZub2Rlc1RvVXBkYXRlLmFkZChkb20pO1xuICB9XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZVN0b3JlPFN0YXRlVHlwZSBleHRlbmRzIFN0YXRlLCBQdWxzZXNUeXBlIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgUHVsc2U8U3RhdGVUeXBlLCBhbnk+Pj4oXG4gIGluaXRpYWxTdGF0ZTogU3RhdGVUeXBlIHwgKCgpID0+IFN0YXRlVHlwZSkgfCBudWxsLFxuICBwdWxzZXM6IFB1bHNlc1R5cGUgJiBUaGlzVHlwZTxQdWxzZXNUeXBlICYgUHVsc2VDb250ZXh0PixcbiAgaW1tdXRhYmxlID0gZmFsc2Vcbik6IFN0b3JlUHVsc2VzPFB1bHNlc1R5cGU+ICYge1xuICBzdGF0ZTogUHJveHlTdGF0ZTxTdGF0ZVR5cGU+O1xuICBvbjogKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbikgPT4gdm9pZDtcbiAgb2ZmOiAoZXZlbnQ6IHN0cmluZywgY2FsbGJhY2s6IEZ1bmN0aW9uKSA9PiB2b2lkO1xufSB7XG4gIGNvbnN0IHN1YnNjcmliZXJzID0gbmV3IFNldDxGdW5jdGlvbj4oKTtcbiAgY29uc3QgZG9tV2l0aFZub2Rlc1RvVXBkYXRlID0gbmV3IFdlYWtTZXQ8RG9tRWxlbWVudD4oKTtcblxuICBjb25zdCBib3VuZFB1bHNlczogUmVjb3JkPHN0cmluZywgRnVuY3Rpb24+ID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIHB1bHNlcykge1xuICAgIGlmICh0eXBlb2YgcHVsc2VzW2tleV0gIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBQdWxzZSAnJHtrZXl9JyBtdXN0IGJlIGEgZnVuY3Rpb25gKTtcbiAgICB9XG4gICAgaWYgKGtleSA9PT0gXCJzdGF0ZVwiKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEEgcHVsc2UgY2Fubm90IGJlIG5hbWVkICdzdGF0ZSdgKTtcbiAgICB9XG4gICAgYm91bmRQdWxzZXNba2V5XSA9IGdldFB1bHNlTWV0aG9kKGtleSk7XG4gIH1cblxuICBjb25zdCBsb2NhbFN0YXRlOiBTdGF0ZVR5cGUgPVxuICAgICh0eXBlb2YgaW5pdGlhbFN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyBpbml0aWFsU3RhdGUoKSA6IGluaXRpYWxTdGF0ZSkgfHwgKHt9IGFzIFN0YXRlVHlwZSk7XG5cbiAgZnVuY3Rpb24gaXNNdXRhYmxlKCkge1xuICAgIGlmIChpbW11dGFibGUpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihcIllvdSBuZWVkIHRvIGNhbGwgYSBwdWxzZSB0byBtb2RpZnkgdGhlIHN0YXRlXCIpO1xuICAgIH1cbiAgfVxuXG4gIGxldCBjdXJyZW50U3RhdGU6IFN0YXRlVHlwZSB8IG51bGwgPSBudWxsO1xuICBsZXQgcHVsc2VDYWxsQ291bnQgPSAwO1xuXG4gIGNvbnN0IHByb3h5U3RhdGUgPSBuZXcgUHJveHkobG9jYWxTdGF0ZSwge1xuICAgIGdldDogKHN0YXRlLCBwcm9wOiBzdHJpbmcpID0+IHtcbiAgICAgIGlmIChjdXJyZW50U3RhdGUpIHtcbiAgICAgICAgcmV0dXJuIGN1cnJlbnRTdGF0ZVtwcm9wXTtcbiAgICAgIH1cblxuICAgICAgY29uc3QgY3VycmVudEVmZmVjdCA9IGVmZmVjdFN0YWNrW2VmZmVjdFN0YWNrLmxlbmd0aCAtIDFdO1xuICAgICAgaWYgKGN1cnJlbnRFZmZlY3QgJiYgIXN1YnNjcmliZXJzLmhhcyhjdXJyZW50RWZmZWN0KSkge1xuICAgICAgICBzdWJzY3JpYmVycy5hZGQoY3VycmVudEVmZmVjdCk7XG4gICAgICB9XG5cbiAgICAgIHJlZ2lzdGVyRG9tU3Vic2NyaXB0aW9uKHN1YnNjcmliZXJzLCBkb21XaXRoVm5vZGVzVG9VcGRhdGUpO1xuXG4gICAgICByZXR1cm4gc3RhdGVbcHJvcF07XG4gICAgfSxcbiAgICBzZXQ6IChzdGF0ZSwgcHJvcDogc3RyaW5nLCB2YWx1ZTogYW55KSA9PiB7XG4gICAgICBpc011dGFibGUoKTtcbiAgICAgIFJlZmxlY3Quc2V0KHN0YXRlLCBwcm9wLCB2YWx1ZSk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIGRlbGV0ZVByb3BlcnR5OiAoc3RhdGUsIHByb3A6IHN0cmluZykgPT4ge1xuICAgICAgaXNNdXRhYmxlKCk7XG4gICAgICBSZWZsZWN0LmRlbGV0ZVByb3BlcnR5KHN0YXRlLCBwcm9wKTtcbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgfSk7XG5cbiAgZnVuY3Rpb24gc3luY1N0YXRlKG5ld1N0YXRlOiBTdGF0ZVR5cGUpIHtcbiAgICBmb3IgKGNvbnN0IGtleSBpbiBuZXdTdGF0ZSkge1xuICAgICAgbG9jYWxTdGF0ZVtrZXldID0gaW1tdXRhYmxlID8gZGVlcEZyZWV6ZShuZXdTdGF0ZVtrZXldKSA6IG5ld1N0YXRlW2tleV07XG4gICAgfVxuICAgIGZvciAoY29uc3Qga2V5IGluIGxvY2FsU3RhdGUpIHtcbiAgICAgIGlmICghKGtleSBpbiBuZXdTdGF0ZSkpIHtcbiAgICAgICAgUmVmbGVjdC5kZWxldGVQcm9wZXJ0eShsb2NhbFN0YXRlLCBrZXkpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIGxldCBkZWJvdW5jZVRpbWVvdXQ6IFJldHVyblR5cGU8dHlwZW9mIHNldFRpbWVvdXQ+IHwgbnVsbCA9IG51bGw7XG4gIGZ1bmN0aW9uIGRlYm91bmNlZFVwZGF0ZSgpIHtcbiAgICBpZiAoZGVib3VuY2VUaW1lb3V0KSB7XG4gICAgICBjbGVhclRpbWVvdXQoZGVib3VuY2VUaW1lb3V0KTtcbiAgICB9XG4gICAgZGVib3VuY2VUaW1lb3V0ID0gc2V0VGltZW91dCgoKSA9PiBzdWJzY3JpYmVycy5mb3JFYWNoKChzdWJzY3JpYmVyKSA9PiBzdWJzY3JpYmVyKCkpLCAwKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHNldFN0YXRlKG5ld1N0YXRlOiBTdGF0ZVR5cGUsIGZsdXNoID0gZmFsc2UpIHtcbiAgICBwdWxzZUNhbGxDb3VudC0tO1xuXG4gICAgLy8gQWx3YXlzIHJlc2V0IGN1cnJlbnRTdGF0ZSBhZnRlciBwdWxzZSBtZXRob2QgY29tcGxldGVzXG4gICAgaWYgKHB1bHNlQ2FsbENvdW50IDw9IDAgJiYgIWZsdXNoKSB7XG4gICAgICBjdXJyZW50U3RhdGUgPSBudWxsO1xuICAgICAgcHVsc2VDYWxsQ291bnQgPSAwO1xuICAgIH1cblxuICAgIC8vIE9ubHkgdHJpZ2dlciB1cGRhdGUgaWYgc3RhdGUgYWN0dWFsbHkgY2hhbmdlZFxuICAgIGlmICgocHVsc2VDYWxsQ291bnQgPiAwICYmICFmbHVzaCkgfHwgIWhhc0NoYW5nZWQobG9jYWxTdGF0ZSwgbmV3U3RhdGUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgc3luY1N0YXRlKG5ld1N0YXRlKTtcbiAgICBkZWJvdW5jZWRVcGRhdGUoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHVuZnJlZXplU3RhdGUoKSB7XG4gICAgaWYgKGN1cnJlbnRTdGF0ZSA9PT0gbnVsbCkge1xuICAgICAgY3VycmVudFN0YXRlID0gZGVlcENsb25lVW5mcmVlemUobG9jYWxTdGF0ZSk7XG4gICAgfVxuICAgIHJldHVybiBjdXJyZW50U3RhdGU7XG4gIH1cblxuICBmdW5jdGlvbiBnZXRQdWxzZU1ldGhvZChrZXk6IHN0cmluZykge1xuICAgIHJldHVybiBmdW5jdGlvbiAodGhpczogYW55LCAuLi5hcmdzOiBhbnlbXSkge1xuICAgICAgcHVsc2VDYWxsQ291bnQrKztcblxuICAgICAgY29uc3Qgc3RhdGUgPSB1bmZyZWV6ZVN0YXRlKCk7XG5cbiAgICAgIGNvbnN0IGNvbnRleHQgPSBPYmplY3QuY3JlYXRlKHB1bHNlcyk7XG5cbiAgICAgIGNvbnRleHQuJGZsdXNoID0gKCkgPT4ge1xuICAgICAgICBpZiAoY3VycmVudFN0YXRlKSB7XG4gICAgICAgICAgc2V0U3RhdGUoY3VycmVudFN0YXRlLCB0cnVlKTtcbiAgICAgICAgfVxuICAgICAgfTtcblxuICAgICAgY29uc3QgZW1wdHlGbHVzaCA9ICgpID0+IHt9O1xuXG4gICAgICBjb25zdCBoYW5kbGVFcnJvciA9IChlcnJvcjogYW55KSA9PiB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGluIHB1bHNlICcke2tleX0nOmAsIGVycm9yKTtcbiAgICAgICAgY29udGV4dC4kZmx1c2ggPSBlbXB0eUZsdXNoO1xuXG4gICAgICAgIHB1bHNlQ2FsbENvdW50LS07XG4gICAgICAgIGlmIChwdWxzZUNhbGxDb3VudCA8PSAwKSB7XG4gICAgICAgICAgY3VycmVudFN0YXRlID0gbnVsbDtcbiAgICAgICAgICBwdWxzZUNhbGxDb3VudCA9IDA7XG4gICAgICAgIH1cblxuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH07XG5cbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChjdXJyZW50LmV2ZW50KSB7XG4gICAgICAgICAgY3VycmVudC5ldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgIGN1cnJlbnQuZXZlbnQuc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcHVsc2VSZXN1bHQgPSBwdWxzZXNba2V5XS5hcHBseShjb250ZXh0LCBbc3RhdGUsIC4uLmFyZ3NdKTtcbiAgICAgICAgaWYgKHB1bHNlUmVzdWx0IGluc3RhbmNlb2YgUHJvbWlzZSkge1xuICAgICAgICAgIHJldHVybiBwdWxzZVJlc3VsdFxuICAgICAgICAgICAgLnRoZW4oKHJlc29sdmVkVmFsdWUpID0+IHtcbiAgICAgICAgICAgICAgc2V0U3RhdGUoc3RhdGUgYXMgU3RhdGVUeXBlKTtcbiAgICAgICAgICAgICAgY29udGV4dC4kZmx1c2ggPSBlbXB0eUZsdXNoO1xuICAgICAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRWYWx1ZTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAuY2F0Y2goaGFuZGxlRXJyb3IpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHNldFN0YXRlKHN0YXRlKTtcbiAgICAgICAgICBjb250ZXh0LiRmbHVzaCA9IGVtcHR5Rmx1c2g7XG4gICAgICAgICAgcmV0dXJuIHB1bHNlUmVzdWx0O1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBoYW5kbGVFcnJvcihlcnJvcik7XG4gICAgICB9XG4gICAgfTtcbiAgfVxuXG4gIHN5bmNTdGF0ZShsb2NhbFN0YXRlKTtcblxuICBjb25zdCBsaXN0ZW5lcnM6IFJlY29yZDxzdHJpbmcsIEZ1bmN0aW9uW10+ID0ge307XG4gIGNvbnN0IHRyaWdnZXIgPSAoZXZlbnQ6IHN0cmluZywgLi4uYXJnczogYW55W10pID0+IHtcbiAgICBpZiAobGlzdGVuZXJzW2V2ZW50XSkge1xuICAgICAgbGlzdGVuZXJzW2V2ZW50XS5mb3JFYWNoKChjYWxsYmFjaykgPT4gY2FsbGJhY2soLi4uYXJncykpO1xuICAgIH1cbiAgfTtcblxuICBjb25zdCBwdWxzZXNQcm94eSA9IG5ldyBQcm94eShib3VuZFB1bHNlcywge1xuICAgIGdldDogKHB1bHNlcywgcHJvcDogc3RyaW5nKSA9PiB7XG4gICAgICBpZiAocHJvcCA9PT0gXCJzdGF0ZVwiKSB7XG4gICAgICAgIHJldHVybiBwcm94eVN0YXRlO1xuICAgICAgfVxuICAgICAgaWYgKHByb3AgPT09IFwib25cIikge1xuICAgICAgICByZXR1cm4gKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbikgPT4ge1xuICAgICAgICAgIGlmICghbGlzdGVuZXJzW2V2ZW50XSkge1xuICAgICAgICAgICAgbGlzdGVuZXJzW2V2ZW50XSA9IFtdO1xuICAgICAgICAgIH1cbiAgICAgICAgICBsaXN0ZW5lcnNbZXZlbnRdLnB1c2goY2FsbGJhY2spO1xuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgaWYgKHByb3AgPT09IFwib2ZmXCIpIHtcbiAgICAgICAgcmV0dXJuIChldmVudDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pID0+IHtcbiAgICAgICAgICBpZiAobGlzdGVuZXJzW2V2ZW50XSkge1xuICAgICAgICAgICAgbGlzdGVuZXJzW2V2ZW50XSA9IGxpc3RlbmVyc1tldmVudF0uZmlsdGVyKChjYikgPT4gY2IgIT09IGNhbGxiYWNrKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICBpZiAoIShwcm9wIGluIHB1bHNlcykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBQdWxzZSAnJHtwcm9wfScgZG9lcyBub3QgZXhpc3RgKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHB1bHNlTWV0aG9kID0gcHVsc2VzW3Byb3BdO1xuXG4gICAgICByZXR1cm4gKC4uLmFyZ3M6IGFueVtdKSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IHB1bHNlTWV0aG9kLmFwcGx5KHB1bHNlTWV0aG9kLCBhcmdzKTtcbiAgICAgICAgaWYgKHJlc3VsdCBpbnN0YW5jZW9mIFByb21pc2UpIHtcbiAgICAgICAgICByZXR1cm4gcmVzdWx0LnRoZW4oKHIpID0+IHtcbiAgICAgICAgICAgIHRyaWdnZXIoXCJwdWxzZVwiLCBwcm9wLCBhcmdzKTtcbiAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRyaWdnZXIoXCJwdWxzZVwiLCBwcm9wLCBhcmdzKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgIH07XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gcHVsc2VzUHJveHkgYXMgU3RvcmVQdWxzZXM8UHVsc2VzVHlwZT4gJiB7XG4gICAgc3RhdGU6IFByb3h5U3RhdGU8U3RhdGVUeXBlPjtcbiAgICBvbjogKGV2ZW50OiBzdHJpbmcsIGNhbGxiYWNrOiBGdW5jdGlvbikgPT4gdm9pZDtcbiAgICBvZmY6IChldmVudDogc3RyaW5nLCBjYWxsYmFjazogRnVuY3Rpb24pID0+IHZvaWQ7XG4gIH07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVQdWxzZVN0b3JlPFN0YXRlVHlwZSBleHRlbmRzIFN0YXRlLCBQdWxzZXNUeXBlIGV4dGVuZHMgUmVjb3JkPHN0cmluZywgUHVsc2U8U3RhdGVUeXBlLCBhbnk+Pj4oXG4gIGluaXRpYWxTdGF0ZTogU3RhdGVUeXBlLFxuICBwdWxzZXM6IFB1bHNlc1R5cGUgJiBUaGlzVHlwZTxQdWxzZXNUeXBlICYgUHVsc2VDb250ZXh0PlxuKSB7XG4gIHJldHVybiBjcmVhdGVTdG9yZShpbml0aWFsU3RhdGUsIHB1bHNlcywgdHJ1ZSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBjcmVhdGVNdXRhYmxlU3RvcmU8U3RhdGVUeXBlIGV4dGVuZHMgU3RhdGUsIFB1bHNlc1R5cGUgZXh0ZW5kcyBSZWNvcmQ8c3RyaW5nLCBQdWxzZTxTdGF0ZVR5cGUsIGFueT4+PihcbiAgaW5pdGlhbFN0YXRlOiBTdGF0ZVR5cGUsXG4gIHB1bHNlczogUHVsc2VzVHlwZSAmIFRoaXNUeXBlPFB1bHNlc1R5cGUgJiBQdWxzZUNvbnRleHQ+XG4pIHtcbiAgY29uc29sZS53YXJuKFxuICAgIFwiV2FybmluZzogWW91IGFyZSB3b3JraW5nIHdpdGggYSBtdXRhYmxlIHN0YXRlLiBBbGwgc3RhdGUgY2hhbmdlcyBtYWRlIG91dHNpZGUgb2YgYSBwdWxzZSB3aWxsIG5vdCB0cmlnZ2VyIGEgcmUtcmVuZGVyLlwiXG4gICk7XG4gIHJldHVybiBjcmVhdGVTdG9yZShpbml0aWFsU3RhdGUsIHB1bHNlcywgZmFsc2UpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlRWZmZWN0KGVmZmVjdDogRnVuY3Rpb24pOiAoKSA9PiB2b2lkIHtcbiAgY29uc3Qgc3Vic2NyaWJlcnMgPSBuZXcgU2V0PEZ1bmN0aW9uPigpO1xuICBcbiAgY29uc3QgcnVuRWZmZWN0ID0gKCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBlZmZlY3RTdGFjay5wdXNoKHJ1bkVmZmVjdCk7XG4gICAgICBlZmZlY3QoKTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgZWZmZWN0U3RhY2sucG9wKCk7XG4gICAgfVxuICB9O1xuICBcbiAgcnVuRWZmZWN0KCk7XG4gIFxuICBjb25zdCBjdXJyZW50Vm5vZGUgPSAoZ2xvYmFsVGhpcyBhcyBhbnkpLmN1cnJlbnQ/LnZub2RlO1xuICBpZiAoY3VycmVudFZub2RlICYmIGN1cnJlbnRWbm9kZS5kb20pIHtcbiAgICBjb25zdCBkb20gPSBjdXJyZW50Vm5vZGUuZG9tO1xuICAgIGNvbnN0IHN1YnNjcmlwdGlvbiA9ICgpID0+IHtcbiAgICAgIHJ1bkVmZmVjdCgpO1xuICAgIH07XG4gICAgc3Vic2NyaWJlcnMuYWRkKHN1YnNjcmlwdGlvbik7XG4gICAgXG4gICAgcmV0dXJuICgpID0+IHtcbiAgICAgIHN1YnNjcmliZXJzLmRlbGV0ZShzdWJzY3JpcHRpb24pO1xuICAgIH07XG4gIH1cbiAgXG4gIHJldHVybiAoKSA9PiB7fTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVB1bHNlPFQ+KGluaXRpYWxWYWx1ZTogVCk6IFsoKSA9PiBULCAobmV3VmFsdWU6IFQgfCAoKGN1cnJlbnQ6IFQpID0+IFQpKSA9PiB2b2lkLCAoKSA9PiB2b2lkXSB7XG4gIGxldCB2YWx1ZSA9IGluaXRpYWxWYWx1ZTtcbiAgY29uc3Qgc3Vic2NyaWJlcnMgPSBuZXcgU2V0PEZ1bmN0aW9uPigpO1xuICBjb25zdCBkb21XaXRoVm5vZGVzVG9VcGRhdGUgPSBuZXcgV2Vha1NldDxEb21FbGVtZW50PigpO1xuXG4gIGNvbnN0IHJ1blN1YnNjcmliZXJzID0gKCkgPT4ge1xuICAgIHN1YnNjcmliZXJzLmZvckVhY2goKHN1YnNjcmliZXIpID0+IHN1YnNjcmliZXIoKSk7XG4gIH07XG5cbiAgY29uc3QgcmVhZCA9ICgpOiBUID0+IHtcbiAgICBjb25zdCBjdXJyZW50RWZmZWN0ID0gZWZmZWN0U3RhY2tbZWZmZWN0U3RhY2subGVuZ3RoIC0gMV07XG4gICAgaWYgKGN1cnJlbnRFZmZlY3QgJiYgIXN1YnNjcmliZXJzLmhhcyhjdXJyZW50RWZmZWN0KSkge1xuICAgICAgc3Vic2NyaWJlcnMuYWRkKGN1cnJlbnRFZmZlY3QpO1xuICAgIH1cbiAgICByZWdpc3RlckRvbVN1YnNjcmlwdGlvbihzdWJzY3JpYmVycywgZG9tV2l0aFZub2Rlc1RvVXBkYXRlKTtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH07XG5cbiAgY29uc3Qgd3JpdGUgPSAobmV3VmFsdWU6IFQgfCAoKGN1cnJlbnQ6IFQpID0+IFQpKTogdm9pZCA9PiB7XG4gICAgY29uc3QgcmVzb2x2ZWRWYWx1ZSA9IHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJmdW5jdGlvblwiID8gKG5ld1ZhbHVlIGFzIChjdXJyZW50OiBUKSA9PiBUKSh2YWx1ZSkgOiBuZXdWYWx1ZTtcbiAgICBpZiAoIWhhc0NoYW5nZWQodmFsdWUsIHJlc29sdmVkVmFsdWUpKSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHZhbHVlID0gcmVzb2x2ZWRWYWx1ZTtcbiAgICBydW5TdWJzY3JpYmVycygpO1xuICB9O1xuXG4gIHJldHVybiBbcmVhZCwgd3JpdGUsIHJ1blN1YnNjcmliZXJzXTtcbn1cbiJdLCJtYXBwaW5ncyI6ImdKQUFBQSxFQUFBLEcseURBQUFDLENBQUFELEVBQUEsQ0FBQUUsYUFBQSxJQUFBQSxFQUFBQyxtQkFBQSxJQUFBQSxFQUFBQyxZQUFBLElBQUFBLEVBQUFDLGlCQUFBLElBQUFBLElBQUEsSSxFQUFBQyxHLEVBQUFOLEUsME1BRUFPLEVBQStEQyxRQUFBLGVBQy9EQyxFQUEwREQsUUFBQSxxQkFZcERFLEVBQTBCLEdBUWhDLFNBQVNDLEVBQXdCQyxFQUE0QkMsR0FDM0QsTUFBTUMsRUFBZVAsRUFBQVEsUUFBUUMsTUFDN0IsSUFBS0YsR0FBZ0JELEVBQXNCSSxJQUFJSCxFQUFhSSxLQUMxRCxPQUdGLElBQUlDLEdBQVksRUFDWkMsRUFBU04sRUFBYUksSUFBSUcsY0FDOUIsS0FBT0QsR0FBUSxDQUNiLEdBQUlQLEVBQXNCSSxJQUFJRyxHQUFTLENBQ3JDRCxHQUFZLEVBQ1os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