(()=>{"use strict";var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,o={};((t,r)=>{for(var n in r)e(t,n,{get:r[n],enumerable:!0})})(o,{createEffect:()=>p,createMutableStore:()=>d,createPulseStore:()=>f});var a,i=(a=o,((o,a,i,u)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let c of r(a))n.call(o,c)||c===i||e(o,c,{get:()=>a[c],enumerable:!(u=t(a,c))||u.enumerable});return o})(e({},"__esModule",{value:!0}),a)),u=require("valyrian.js"),c=require("valyrian.js/utils"),s=[];function l(e,t,r=!1){const n=new Set,o=new WeakSet,a=("function"==typeof e?e():e)||{};function i(){if(r)throw new Error("You need to call a pulse to modify the state")}const l=new Proxy(a||{},{get:(e,t)=>{const r=s[s.length-1];r&&!n.has(r)&&n.add(r);const a=u.current.vnode;if(a&&!o.has(a)){const e=()=>{if(!a.dom)return n.delete(e),void o.delete(a);(0,u.updateVnode)(a)};n.add(e),o.add(a)}return e[t]},set:(e,t,r)=>(i(),Reflect.set(e,t,r),!0),deleteProperty:(e,t)=>(i(),Reflect.deleteProperty(e,t),!0)});function f(e){for(const t in e)a[t]=r?(0,c.deepFreeze)(e[t]):e[t];for(const t in a)t in e||Reflect.deleteProperty(a,t)}function d(e){(0,c.hasChanged)(a,e)&&(f(e),n.forEach(e=>e()))}function p(e){return(...r)=>{const n=(0,c.deepCloneUnfreeze)(a),o=t[e](n,...r);if(o instanceof Promise)return o.then(()=>d(n)).catch(e=>{console.error("Error in pulse:",e)});d(n)}}const y={};for(const e in t){if("function"!=typeof t[e])throw new Error(`Pulse '${e}' must be a function`);y[e]=p(e)}const h=new Proxy(y,{get:(e,t)=>{if(!(t in e))throw new Error(`Pulse '${t}' does not exist`);return e[t]}});return f(a),function(){return[l,h]}}function f(e,t){return l(e,t,!0)}function d(e,t){return console.warn("Warning: You are working with a mutable state. This can lead to unpredictable behavior. All state changes made outside of a pulse will not trigger a re-render."),l(e,t,!1)}function p(e){const t=()=>{try{s.push(t),e()}finally{s.pop()}};t()}"undefined"!=typeof module?module.exports=i:self.ValyrianPulseStore=i})();//# sourceMappingURL=index.min.js.map