(()=>{"use strict";var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,r=Object.getOwnPropertyNames,n=Object.prototype.hasOwnProperty,o={};((t,r)=>{for(var n in r)e(t,n,{get:r[n],enumerable:!0})})(o,{createEffect:()=>p,createMutableStore:()=>d,createPulseStore:()=>f});var a,i=(a=o,((o,a,i,u)=>{if(a&&"object"==typeof a||"function"==typeof a)for(let s of r(a))n.call(o,s)||s===i||e(o,s,{get:()=>a[s],enumerable:!(u=t(a,s))||u.enumerable});return o})(e({},"__esModule",{value:!0}),a)),u=require("valyrian.js"),s=require("valyrian.js/utils"),c=[];function l(e,t,r=!1){const n=new Set,o=new WeakSet,a={};for(const e in t){if("function"!=typeof t[e])throw new Error(`Pulse '${e}' must be a function`);if("state"===e)throw new Error("A pulse cannot be named 'state'");a[e]=h(e)}const i=("function"==typeof e?e():e)||{};function l(){if(r)throw new Error("You need to call a pulse to modify the state")}const f=new Proxy(i,{get:(e,t)=>{const r=c[c.length-1];r&&!n.has(r)&&n.add(r);const a=u.current.vnode;if(a&&!o.has(a.dom)){const e=a.dom,t=()=>{if(!e.parentNode)return n.delete(t),void o.delete(e);(0,u.updateVnode)(e.vnode)};n.add(t),o.add(e)}return e[t]},set:(e,t,r)=>(l(),Reflect.set(e,t,r),!0),deleteProperty:(e,t)=>(l(),Reflect.deleteProperty(e,t),!0)});function d(e){for(const t in e)i[t]=r?(0,s.deepFreeze)(e[t]):e[t];for(const t in i)t in e||Reflect.deleteProperty(i,t)}let p=null;function y(e){(0,s.hasChanged)(i,e)&&(d(e),clearTimeout(p),p=setTimeout(()=>n.forEach(e=>e()),0))}function h(e){return(...r)=>{const n=(0,s.deepCloneUnfreeze)(i),o=t[e](n,...r);if(o instanceof Promise)return o.then(()=>y(n)).catch(e=>{console.error("Error in pulse:",e)});y(n)}}d(i);return new Proxy(a,{get:(e,t)=>{if("state"===t)return f;if(!(t in e))throw new Error(`Pulse '${t}' does not exist`);return e[t]}})}function f(e,t){return l(e,t,!0)}function d(e,t){return console.warn("Warning: You are working with a mutable state. This can lead to unpredictable behavior. All state changes made outside of a pulse will not trigger a re-render."),l(e,t,!1)}function p(e,t){const r=()=>{try{c.push(r),e()}finally{c.pop()}};r()}"undefined"!=typeof module?module.exports=i:self.ValyrianPulseStore=i})();//# sourceMappingURL=index.min.js.map