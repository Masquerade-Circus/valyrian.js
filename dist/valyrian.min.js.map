{"version":3,"file":"valyrian.min.js","sources":["../lib/index.js"],"sourcesContent":["let UND;\nlet oncreate = 'v-create';\nlet onupdate = 'v-update';\nlet onremove = 'v-remove';\nlet onbeforeupdate = 'v-beforeupdate';\nlet mainNode;\nlet oldMainNode;\nlet mountedComponent;\nlet FALSE = false;\nlet TRUE = true;\nlet NIL = null;\nlet emptyObject = Object.create(NIL);\nlet emptyArray = [];\n\nfunction Vnode(name, props, children) {\n  this.props = props || emptyObject;\n  this.children = children;\n  this.name = name;\n};\nVnode.prototype = {\n  isSVG: FALSE\n};\n\nfunction TextVnode() {}\nTextVnode.prototype = {\n  props: emptyObject,\n  children: emptyArray,\n  isSVG: FALSE\n};\n\nlet emptyNode = new TextVnode();\n\nfunction createElement(tag, isSVG) {\n  return isSVG ?\n    document.createElementNS('http://www.w3.org/2000/svg', tag) :\n    document.createElement(tag);\n}\n\nfunction v(tagOrComponent, props, ...children) {\n  return new Vnode(tagOrComponent, props, children);\n};\n\nv.isNode = typeof window === 'undefined';\n\n// This could be extended to do a deep clone\n// This mutates the component\nv.addState = (component, state) => Object.assign(component, state);\n\n// Hydrates the current dom before mount\nv.dom2vnode = function (dom) {\n  let vnode;\n  if (dom.nodeType === 3) {\n    vnode = new TextVnode();\n    vnode.dom = dom;\n  } else if (dom.nodeType === 1) {\n    let name = dom.nodeName;\n    vnode = new Vnode(\n      name,\n      {},\n      []\n    );\n    vnode.dom = dom;\n\n    for (let l = dom.attributes.length; l--;) {\n      let property = dom.attributes[l];\n      vnode.props[property.nodeName] = property.nodeValue;\n    }\n\n    for (let i = 0, l = dom.childNodes.length; i < l; i++) {\n      let childVnode = v.dom2vnode(dom.childNodes[i]);\n      childVnode && vnode.children.push(childVnode);\n    }\n  }\n  return vnode;\n};\n\nv.trust = (htmlString) => {\n  let div = createElement('div');\n  div.innerHTML = htmlString.trim();\n\n  return emptyArray.map.call(div.childNodes, (item) => v.dom2vnode(item));\n};\n\n// Plugin system\nlet plugins = new Map();\nv.usePlugin = (plugin, options) => !plugins.has(plugin) && plugins.set(plugin, TRUE) && plugin(v, options);\n\nv.reservedWords = {\n  key: NIL,\n  'v-noop': NIL,\n  [oncreate]: NIL,\n  [onbeforeupdate]: NIL,\n  [onupdate]: NIL,\n  [onremove]: NIL\n};\n\nlet attachedListeners = {};\nfunction eventListener(e) {\n  let dom = e.target;\n  let name = `__on${e.type}`;\n  while (dom) {\n    if (name in dom) {\n      dom[name](e);\n      if (e.defaultPrevented === FALSE) {\n        v.update();\n      }\n      return;\n    }\n    dom = dom.parentNode;\n  }\n};\n\nfunction lifecycleCall(vnode, methodName, oldNode) {\n  if (methodName === onremove) {\n    cleanupVnode(vnode);\n    for (let i = 0, l = vnode.children.length; i < l; i++) {\n      lifecycleCall(vnode.children[i], onremove);\n    }\n  }\n\n  if (methodName in vnode.props) {\n    return vnode.props[methodName](vnode, oldNode);\n  }\n}\n\nv.updateProperty = (name, newNode, oldNode, isSVG) => {\n  let value = newNode.props[name];\n  if (name in v.reservedWords) {\n    if (typeof v.reservedWords[name] === 'function') {\n      v.reservedWords[name](value, newNode, oldNode, isSVG);\n    }\n  } else if (typeof value === 'function') {\n    name = `__${name}`;\n    if (name in attachedListeners === FALSE) {\n      document.addEventListener(name.slice(4), eventListener);\n      attachedListeners[name] = TRUE;\n    };\n    newNode.dom[name] = value;\n  } else if (name in newNode.dom && !isSVG) {\n    if (newNode.dom[name] !== value) {\n      newNode.dom[name] = value;\n    }\n  } else if (value !== oldNode.props[name]) {\n    newNode.dom.setAttribute(name, value);\n  }\n};\n\nfunction updateProps(newNode, oldNode, isSVG) {\n  for (let name in newNode.props) {\n    v.updateProperty(name, newNode, oldNode, isSVG);\n  }\n}\n\nfunction createNode(newNode, isSVG) {\n  newNode.dom = createElement(newNode.name, isSVG);\n  updateProps(newNode, emptyNode, isSVG);\n  lifecycleCall(newNode, oncreate);\n  patch(newNode, emptyNode, isSVG);\n}\n\nfunction updateNode(newNode, oldNode, isSVG) {\n  newNode.dom = oldNode.dom;\n  if ('v-noop' in newNode.props || lifecycleCall(newNode, onbeforeupdate, oldNode) === FALSE) {\n    newNode.children = oldNode.children;\n  } else {\n    for (let name in oldNode.props) {\n      if (name in v.reservedWords === FALSE && name in newNode.props === FALSE && typeof oldNode.props[name] !== 'function') {\n        if (name in newNode.dom) {\n          newNode.dom[name] = NIL;\n        } else {\n          newNode.dom.removeAttribute(name);\n        }\n      }\n    }\n    updateProps(newNode, oldNode, isSVG);\n    lifecycleCall(newNode, !v.isMounted ? oncreate : onupdate, oldNode);\n    patch(newNode, oldNode, isSVG);\n  }\n}\n\nfunction removeNode($parent, oldNode) {\n  lifecycleCall(oldNode, onremove);\n  $parent.removeChild(oldNode.dom);\n}\n\nfunction updateKeyedNode($parent, newNode, compareNode, isSVG, newIndex) {\n  // Moved or updated\n  'dom' in compareNode ?\n    updateNode(newNode, compareNode, isSVG) :\n    createNode(newNode, isSVG);\n\n  if (newNode.dom !== $parent.childNodes[newIndex]) {\n    $parent.childNodes[newIndex] !== UND ?\n      $parent.replaceChild(newNode.dom, $parent.childNodes[newIndex]) :\n      $parent.appendChild(newNode.dom);\n  }\n}\n\nfunction getKeys(list) {\n  let keys = [];\n  for (let i = 0, l = list.length; i < l; i++) {\n    keys.push(list[i].props.key);\n  }\n  return keys;\n}\n\nv.onCleanup = function (callback) {\n  if (v.current.parentVnode.onCleanup === UND) {\n    v.current.parentVnode.onCleanup = [];\n    v.current.parentVnode.cleanUp = TRUE;\n  }\n  v.current.parentVnode.onCleanup.push(callback);\n};\n\nfunction cleanupVnode(vnode) {\n  if (vnode.cleanUp) {\n    for (let i = 0, l = vnode.onCleanup.length; i < l; i++) {\n      vnode.onCleanup[i]();\n    }\n  }\n}\n\nv.current = {\n  parentVnode: NIL,\n  oldParentVnode: NIL,\n  component: NIL\n};\n\n// eslint-disable-next-line complexity,sonarjs/cognitive-complexity\nfunction patch(parentNode, oldParentNode, isSVG) {\n  let {dom: $parent, children: newTree} = parentNode;\n  let oldTree = oldParentNode.children;\n  v.current.parentVnode = parentNode;\n  v.current.oldParentVnode = oldParentNode;\n  cleanupVnode(oldParentNode);\n\n  if (Array.isArray(newTree) === FALSE) {\n    newTree = [newTree];\n  }\n\n  // New tree is empty so just remove all old nodes\n  if (newTree.length === 0) {\n    for (let i = oldTree.length; i--;) {\n      lifecycleCall(oldTree[i], onremove);\n    }\n    $parent.textContent = '';\n  } else {\n\n    // Flatten children\n    for (let i = 0; i < newTree.length; i++) {\n      let childVnode = newTree[i];\n\n      if (childVnode instanceof Vnode) {\n        v.current.component = childVnode;\n        if (typeof childVnode.name !== 'string') {\n          let viewMethod = 'view' in childVnode.name ? childVnode.name.view : childVnode.name;\n          newTree.splice(i, 1, ...[viewMethod.call(viewMethod, childVnode.props, ...childVnode.children)]);\n          i--;\n        } else {\n          if (childVnode.name === 'svg') {\n            childVnode.isSVG = TRUE;\n          }\n        }\n      } else if (Array.isArray(childVnode)) {\n        newTree.splice(i, 1, ...childVnode);\n        i--;\n      }\n    }\n\n    let firstNode = newTree[0];\n\n    // Is keyed list\n    if (oldTree.length > 0 && firstNode instanceof Vnode && 'key' in firstNode.props) {\n      let oldKeys = getKeys(oldTree);\n      let newKeys = getKeys(newTree);\n\n      for (let i = 0, l = newKeys.length; i < l; i++) {\n        let key = newKeys[i];\n        let newNode = newTree[i];\n        isSVG = isSVG || newNode.isSVG;\n\n        // Updated: Same key\n        if (key === oldKeys[i]) {\n          oldTree[i].processed = TRUE;\n          updateKeyedNode($parent, newNode, oldTree[i], isSVG, i);\n        } else {\n          let oldIndex = oldKeys.indexOf(key);\n          let newIndex = i >= oldKeys.length ? UND : i;\n\n          // Moved: Key exists in old keys\n          if (oldIndex !== -1) {\n            oldTree[oldIndex].processed = TRUE;\n            updateKeyedNode($parent, newNode, oldTree[oldIndex], isSVG, newIndex);\n          // Added: Key does not exists in old keys\n          } else {\n            updateKeyedNode($parent, newNode, emptyNode, isSVG, newIndex);\n          }\n        }\n      }\n\n      // Delete unprocessed old keys\n      for (let i = 0, l = oldTree.length; i < l; i++) {\n        if ('processed' in oldTree[i] === FALSE) {\n          lifecycleCall(oldTree[i], onremove);\n          oldTree[i].dom.parentNode && $parent.removeChild(oldTree[i].dom);\n        }\n      }\n\n    // Not keyed list or first render so use the simple algorithm\n    } else {\n      if (oldTree.length > newTree.length) {\n        // Remove deleted nodes\n        for (let i = oldTree.length, l = newTree.length; i-- && i >= l;) {\n          removeNode($parent, oldTree[i]);\n        }\n      }\n\n      for (let i = 0, l = newTree.length; i < l; i++) {\n        let newNode = newTree[i];\n        let oldNode = oldTree[i];\n\n        // Is vnode\n        if (newNode instanceof Vnode) {\n          isSVG = isSVG || newNode.isSVG;\n\n          // Added\n          if (oldNode === UND) {\n            createNode(newNode, isSVG);\n            $parent.appendChild(newNode.dom);\n          // Replaced\n          } else if (newNode.name !== oldNode.name) {\n            createNode(newNode, isSVG);\n            lifecycleCall(oldNode, onremove);\n            $parent.replaceChild(newNode.dom, oldNode.dom);\n          // Updated\n          } else {\n            updateNode(newNode, oldNode, isSVG);\n          }\n\n        // Is text\n        } else {\n          let dom;\n\n          // Added\n          if (oldNode === UND) {\n            dom = document.createTextNode(newNode);\n            $parent.appendChild(dom);\n          // Replace element\n          } else if (oldNode instanceof Vnode) {\n            dom = document.createTextNode(newNode);\n            lifecycleCall(oldNode, onremove);\n            $parent.replaceChild(dom, oldNode.dom);\n            // Updated\n          } else {\n            dom = oldNode.dom;\n            if (newNode !== dom.nodeValue) {\n              dom.nodeValue = newNode;\n            }\n          }\n\n          newTree[i] = new TextVnode();\n          newTree[i].dom = dom;\n        }\n      }\n    }\n  }\n\n  parentNode.children = newTree;\n};\n\nv.update = (props, ...children) => {\n  if (mainNode) {\n    if (mountedComponent !== UND) {\n      oldMainNode = mainNode;\n      mainNode = new Vnode(mainNode.name, mainNode.props, v(mountedComponent, props, children));\n      mainNode.dom = oldMainNode.dom;\n      patch(mainNode, oldMainNode, mainNode.isSVG);\n      v.isMounted = TRUE;\n    }\n\n    return v.isNode && mainNode.dom.innerHTML;\n  }\n};\n\nv.mount = (container, component, props, ...children) => {\n  let mainContainer = v.isNode\n    ? createElement('div')\n    : typeof container === 'string'\n      ? document.querySelectorAll(container)[0]\n      : container;\n\n  mainNode = v.dom2vnode(mainContainer);\n  mountedComponent = component;\n\n  return v.update(props, children);\n};\n\nv.unmount = () => {\n  mountedComponent = () => {};\n  let result = v.update();\n  mountedComponent = UND;\n  v.isMounted = FALSE;\n  return result;\n};\n\nv.directive = (directive, handler) => directive in v.reservedWords === FALSE && (v.reservedWords[directive] = handler);\nv.directive('v-for', (set, vnode) => {\n  let handler = vnode.children[0];\n  vnode.children = [];\n  for (let i = 0, l = set.length; i < l; i++) {\n    vnode.children[i] = handler(set[i], i);\n  }\n});\n\nlet hideDirective = (test) => (bool, vnode, oldnode) => {\n  if (bool === test) {\n    let dom = document.createTextNode('');\n    if (oldnode && oldnode.dom && oldnode.dom.parentNode) {\n      lifecycleCall(oldnode, onremove);\n      oldnode.dom.parentNode.replaceChild(dom, oldnode.dom);\n    }\n    vnode.name = '';\n    vnode.children = emptyArray;\n    vnode.props = emptyObject;\n    vnode.dom = dom;\n  }\n};\n\nv.directive('v-if', hideDirective(FALSE));\nv.directive('v-unless', hideDirective(TRUE));\nv.directive('v-show', (bool, vnode) => vnode.dom.style.display = bool === FALSE ? 'none' : '');\n\n(v.isNode ? global : window).v = v;\n"],"names":[],"mappings":"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"}