(()=>{"use strict";var e=Object.defineProperty,n=Object.getOwnPropertyDescriptor,t=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,o={};((n,t)=>{for(var i in t)e(n,i,{get:t[i],enumerable:!0})})(o,{NetworkError:()=>d,NetworkEvent:()=>c,NetworkManager:()=>f,SignalLevel:()=>h});var s,r=(s=o,((o,s,r,a)=>{if(s&&"object"==typeof s||"function"==typeof s)for(let l of t(s))i.call(o,l)||l===r||e(o,l,{get:()=>s[l],enumerable:!(a=n(s,l))||a.enumerable});return o})(e({},"__esModule",{value:!0}),s)),a=require("valyrian.js"),l=require("valyrian.js/utils"),c=(e=>(e.ONLINE="online",e.OFFLINE="offline",e.CHANGE="change",e))(c||{}),h=(e=>(e[e.None=0]="None",e[e.Poor=1]="Poor",e[e.Fair=2]="Fair",e[e.Good=3]="Good",e[e.Excellent=4]="Excellent",e))(h||{}),d=class extends Error{},f=class{#e=new Set;#n=new Set;#t=new Set;#i;#o;#s;#r=()=>this.notifyListeners("online");#a=()=>this.notifyListeners("offline");#l=()=>this.notifyListeners("change");NetworkEvent=c;constructor(e={}){const n=e.runtime||{};if(this.#i=n.isNodeJs??a.isNodeJs,this.#o=n.navigator??(globalThis.navigator||null),this.#s=n.window??(globalThis.window||null),!this.#i&&this.#s&&this.#o){(0,l.isFunction)(this.#s.addEventListener)&&(this.#s.addEventListener("online",this.#r),this.#s.addEventListener("offline",this.#a));try{const e=this.getConnection();(0,l.isFunction)(e.addEventListener)&&e.addEventListener("change",this.#l)}catch{}}}getConnection(){if(!this.#o)throw new d("Navigator not available");const e=this.#o.connection||this.#o.mozConnection||this.#o.webkitConnection;if(!e)throw new d("Connection not available");return e}getNetworkStatus(){if(this.#i||!this.#o)return{online:!0};const e=this.#o.onLine;try{const n=this.getConnection();return{online:e,effectiveType:(0,l.isString)(n.effectiveType)?n.effectiveType:void 0,downlink:(0,l.isFiniteNumber)(n.downlink)?n.downlink:void 0,rtt:(0,l.isFiniteNumber)(n.rtt)?n.rtt:void 0,saveData:!0===n.saveData}}catch{return{online:e}}}getSignalLevel(){const e=this.getNetworkStatus();return e.online?"slow-2g"===e.effectiveType?0:e.effectiveType?"4g"===e.effectiveType?(0,l.isFiniteNumber)(e.downlink)&&e.downlink>5&&(0,l.isFiniteNumber)(e.rtt)&&e.rtt<100?4:(0,l.isFiniteNumber)(e.downlink)&&e.downlink>=2?3:2:"3g"===e.effectiveType&&(0,l.isFiniteNumber)(e.downlink)&&e.downlink>=1?2:1:3:0}isConnectionPoor(){return 0===this.getSignalLevel()}getStatus(){return this.getNetworkStatus()}notifyListeners(e){const n=this.getNetworkStatus(),t=this.getListeners(e);for(const e of t)e(n)}getListeners(e){switch(e){case"online":return this.#e;case"offline":return this.#n;case"change":return this.#t;default:throw new d("Invalid event type")}}on(e,n){return this.getListeners(e).add(n),()=>this.off(e,n)}off(e,n){this.getListeners(e).delete(n)}destroy(){if(!this.#i){this.#s&&(0,l.isFunction)(this.#s.removeEventListener)&&(this.#s.removeEventListener("online",this.#r),this.#s.removeEventListener("offline",this.#a));try{const e=this.getConnection();(0,l.isFunction)(e.removeEventListener)&&e.removeEventListener("change",this.#l)}catch{}}this.#e.clear(),this.#n.clear(),this.#t.clear()}};"undefined"!=typeof module?module.exports=r:self.ValyrianNetwork=r})();//# sourceMappingURL=index.min.js.map