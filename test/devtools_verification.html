<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><title>Redux DevTools Verification</title></head><body><h1>Redux DevTools Verification</h1><div id="status">Running...</div><ul id="logs"></ul><script type="importmap">{
                "imports": {
                  "valyrian.js": "../dist/index.mjs",
                  "valyrian.js/utils": "../dist/utils/index.mjs",
                  "valyrian.js/flux-store": "../dist/flux-store/index.mjs",
                  "valyrian.js/pulses": "../dist/pulses/index.mjs",
                  "valyrian.js/redux-devtools": "../dist/redux-devtools/index.mjs"
                }
              }</script><script type="module">
            import { FluxStore } from "valyrian.js/flux-store";
            import { createPulseStore, createPulse } from "valyrian.js/pulses";
            import { connectFluxStore, connectPulseStore, connectPulse } from "valyrian.js/redux-devtools";

            const logs = [];
            const log = (msg) => {
                console.log(msg);
                logs.push(msg);
                const li = document.createElement("li");
                li.textContent = JSON.stringify(msg);
                document.getElementById("logs").appendChild(li);
            };
            log.connect = (options) => log({ type: "connect", options });
            log.init = (state) => log({ type: "init", state });
            log.send = (action, state) => log({ type: "send", action, state });

            async function runTest() {
                try {
                    // Test FluxStore
                    log("--- Testing FluxStore ---");
                    const fluxStore = new FluxStore({
                        state: { count: 0 },
                        mutations: {
                            increment(state) { state.count++; }
                        }
                    });
                    log.connect({ name: "FluxTest" });
                    log.init({ count: 0 });
                    connectFluxStore(fluxStore, { name: "FluxTest" });
                    log.send({ type: "increment" }, { count: 1 });
                    fluxStore.commit("increment");

                    // Test PulseStore
                    log("--- Testing PulseStore ---");
                    const pulseStore = createPulseStore(
                        { count: 2 },
                        {
                            increment(state) { state.count++; }
                        }
                    );
                    log.connect({ name: "PulseTest" });
                    log.init({ count: 2 });
                    connectPulseStore(pulseStore, { name: "PulseTest" });
                    log.send({ type: "increment" }, { count: 3 });
                    pulseStore.increment();

                    // Test Individual Pulse
                    log("--- Testing Individual Pulse ---");
                    log.connect({ name: "IndividualPulseTest" });
                    log.init({ count: 4 });
                    const pulse = createPulse( 4 )
                    const [ read, write ] = connectPulse( pulse, { name: "IndividualPulseTest" } )
                    log.send({ type: "update", payload: 5 }, { count: 5 });
                    write( 5 )

                    // Wait for async updates if any (PulseStore might be async)
                    await new Promise(r => setTimeout(r, 100));

                    // Verify logs
                    const events = logs.filter(l => typeof l === 'object');
                    
                    const fluxConnect = events.find(e => e.type === "connect" && e.options.name === "FluxTest");
                    const fluxSend = events.find(e => e.type === "send" && e.action.type === "increment" && e.state.count === 1);
                    
                    const pulseConnect = events.find(e => e.type === "connect" && e.options.name === "PulseTest");
                    const pulseSend = events.find(e => e.type === "send" && e.action.type === "increment" && e.state.count === 3);

                    const individualConnect = events.find(e => e.type === "connect" && e.options.name === "IndividualPulseTest");
                    const individualSend = events.find(e => e.type === "send" && e.action.type === "update" && e.state.count === 5);
                    
                    if (fluxConnect && fluxSend && pulseConnect && pulseSend && individualConnect && individualSend) {
                        document.getElementById("status").textContent = "SUCCESS";
                        document.getElementById("status").style.color = "green";
                    } else {
                        document.getElementById("status").textContent = "FAILURE";
                        document.getElementById("status").style.color = "red";
                        console.error("Missing events", { fluxConnect, fluxSend, pulseConnect, pulseSend, individualConnect, individualSend });
                    }

                } catch (e) {
                    document.getElementById("status").textContent = "ERROR: " + e.message;
                    document.getElementById("status").style.color = "red";
                    console.error(e);
                }
            }

            runTest();
          </script></body></html>